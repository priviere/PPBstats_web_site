<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run Hierarchical Bayesian GxE model — model_bh_GxE • PPBstats</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Run Hierarchical Bayesian GxE model — model_bh_GxE" />

<meta property="og:description" content="model_bh_GxE runs Hierarchical Bayesian GxE modelto get main germplasm, environment and sensitivity effects over the network" />





<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PPBstats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/1.install.html">Download and install</a>
</li>
<li>
  <a href="../articles/2.book.html">Book</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/3.thanks.html">Aknowledgement</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/priviere/PPBstats/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run Hierarchical Bayesian GxE model</h1>
    <small class="dont-index">Source: <a href='http://github.com/priviere/PPBstats/blob/master/R/model_bh_GxE.R'><code>R/model_bh_GxE.R</code></a></small>
    <div class="hidden name"><code>model_bh_GxE.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>model_bh_GxE</code> runs Hierarchical Bayesian GxE modelto get main germplasm, environment and sensitivity effects over the network</p>
    
    </div>

    <pre class="usage"><span class='fu'>model_bh_GxE</span>(<span class='no'>data</span>, <span class='no'>variable</span>, <span class='kw'>nb_iterations</span> <span class='kw'>=</span> <span class='fl'>1e+05</span>, <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>return.alpha</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>return.sigma_alpha</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>return.beta</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>return.sigma_beta</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>return.theta</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>return.sigma_theta</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>return.epsilon</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>return.sigma_epsilon</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>return.DIC</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>The data frame on which the model is run. It should come from <code><a href='format_data_PPBstats.data_agro.html'>format_data_PPBstats.data_agro</a></code></p></td>
    </tr>
    <tr>
      <th>variable</th>
      <td><p>The variable on which runs the model</p></td>
    </tr>
    <tr>
      <th>nb_iterations</th>
      <td><p>Number of iterations of the MCMC</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>thinning interval to reduce autocorrelations between samples of the MCMC</p></td>
    </tr>
    <tr>
      <th>return.alpha</th>
      <td><p>Return the value for each germplasm main effect (alpha_i)</p></td>
    </tr>
    <tr>
      <th>return.sigma_alpha</th>
      <td><p>Return the value of the variance of the distribution where the alpha_i come from</p></td>
    </tr>
    <tr>
      <th>return.beta</th>
      <td><p>Return the value for each sensitivity to environments (beta_i)</p></td>
    </tr>
    <tr>
      <th>return.sigma_beta</th>
      <td><p>Return the value of the variance of the distribution where the beta_i come from</p></td>
    </tr>
    <tr>
      <th>return.theta</th>
      <td><p>Return the value for each environment main effect (theta_j)</p></td>
    </tr>
    <tr>
      <th>return.sigma_theta</th>
      <td><p>Return the value of the variance of the distribution where the theta_j come from</p></td>
    </tr>
    <tr>
      <th>return.epsilon</th>
      <td><p>Return the value of the residuals of the model (epsilon_ij)</p></td>
    </tr>
    <tr>
      <th>return.sigma_epsilon</th>
      <td><p>Return the value of the variance of the distribution where the epsilon_ij come from</p></td>
    </tr>
    <tr>
      <th>return.DIC</th>
      <td><p>Return the DIC value of the model. See details for more informations.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns a list with</p>
<ul>
<li><p>"data.presence.absence.matrix": a matrix germplasm x environment with the number of occurence in the data</p></li>
<li><p>"model.presence.absence.matrix": a matrix germplasm x environment with the number of occurence in the data used for the model (i.e. with at least two germplasm by environments.)</p></li>
<li><p>"germplasm.not.used": the vector of germplasms not used in the analysis because they were not on at least two environments. If NULL, all the germplasms were used in the analysis.</p></li>
<li><p>"MCMC": a list with the two MCMC chains (mcmc object) from the model</p></li>
<li><p>"epsilon": a vector with the median value of the epsilon_ij</p></li>
<li><p>"DIC": the DIC value of the model</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Hierarchical Bayesian GxE model estimates germplasm (alpha_i), environment (theta_j) and sensitivity to interaction (beta_i) effects. 
An environment is a combinaison of a location and a year.</p>
<p>The different effects are taken in different distributions of respective variances sigma_alpha, sigma_theta and sigma_beta. 
This model takes into acount all the information on the network in order to cope with the high disequilibrium in the dataset (i.e. high percentage of missing GxE combinaisons on the network).</p>
<p>First, the additive model is done. This model gives intitial values of some parameters of the Hierarchical Finlay Wilkinson model which is done next.</p>
<p>The model is run on data set where germplasms are on at least two environments.</p>
<p>More information can be found in the book: https://priviere.github.io/PPBstats_book/family-2.html#model-2</p>
<p>For DIC value, see ?<code>dic.samples</code> from the <code>rjags</code> package for more information.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>P. Riviere, J.C. Dawson, I. Goldringer, and O. David. Hierarchical multiplicative modeling of genotype x environment interaction for flexible experiments in decentralized participatory plant breeding. In prep, 2015.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>
<ul>
<li><p><code><a href='check_model.html'>check_model</a></code></p></li>
<li><p><code><a href='check_model.fit_model_bh_GxE.html'>check_model.fit_model_bh_GxE</a></code></p></li>
<li><p><code><a href='cross_validation_model_bh_GxE.html'>cross_validation_model_bh_GxE</a></code></p></li>
<li><p><code><a href='predict_the_past_model_bh_GxE.html'>predict_the_past_model_bh_GxE</a></code></p></li>
</ul>
</div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Pierre Riviere.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


