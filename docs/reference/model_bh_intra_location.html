<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Run Hierarchical Bayesian intra-location model — model_bh_intra_location • PPBstats</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Run Hierarchical Bayesian intra-location model — model_bh_intra_location" />

<meta property="og:description" content="model_bh_intra_location runs Hierarchical Bayesian intra-location model to get mean comparisons on each environment of the network. See details for more information." />





<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PPBstats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/1.install.html">Download and install</a>
</li>
<li>
  <a href="../articles/2.book.html">Book</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../articles/3.thanks.html">Aknowledgement</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/priviere/PPBstats/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Run Hierarchical Bayesian intra-location model</h1>
    <small class="dont-index">Source: <a href='http://github.com/priviere/PPBstats/blob/master/R/model_bh_intra_location.R'><code>R/model_bh_intra_location.R</code></a></small>
    <div class="hidden name"><code>model_bh_intra_location.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>model_bh_intra_location</code> runs Hierarchical Bayesian intra-location model to get mean comparisons on each environment of the network. See details for more information.</p>
    
    </div>

    <pre class="usage"><span class='fu'>model_bh_intra_location</span>(<span class='no'>data</span>, <span class='no'>variable</span>, <span class='kw'>nb_iterations</span> <span class='kw'>=</span> <span class='fl'>1e+05</span>,
  <span class='kw'>thin</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>return.mu</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>return.beta</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>return.sigma</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>return.nu</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>return.rho</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>return.epsilon</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>return.DIC</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>nu.max</span> <span class='kw'>=</span> <span class='fl'>10</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>The data frame on which the model is run. It should come from <code><a href='format_data_PPBstats.data_agro.html'>format_data_PPBstats.data_agro</a></code></p></td>
    </tr>
    <tr>
      <th>variable</th>
      <td><p>The variable on which runs the model</p></td>
    </tr>
    <tr>
      <th>nb_iterations</th>
      <td><p>Number of iterations of the MCMC</p></td>
    </tr>
    <tr>
      <th>thin</th>
      <td><p>thinning interval to reduce autocorrelations between samples of the MCMC</p></td>
    </tr>
    <tr>
      <th>return.mu</th>
      <td><p>Return the value for each entry in each environment (mu_ij)</p></td>
    </tr>
    <tr>
      <th>return.beta</th>
      <td><p>Return the value for each block in each environment (beta_jk)</p></td>
    </tr>
    <tr>
      <th>return.sigma</th>
      <td><p>Return the value for each within-environment variance (sigma_j)</p></td>
    </tr>
    <tr>
      <th>return.nu</th>
      <td><p>Return the value of nu</p></td>
    </tr>
    <tr>
      <th>return.rho</th>
      <td><p>Return the value of rho</p></td>
    </tr>
    <tr>
      <th>return.epsilon</th>
      <td><p>Return the value of all residuals in each environment (epsilon_ijk)</p></td>
    </tr>
    <tr>
      <th>return.DIC</th>
      <td><p>Return the DIC value of the model. See details for more information.</p></td>
    </tr>
    <tr>
      <th>nu.max</th>
      <td><p>Set the nu.max. It is 10 by default</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns a list with</p>
<ul>
<li><p>"data.model1": the dataframe used to run  Hierarchical Bayesian intra-location model</p></li>
<li><p>"presence.absence.matrix": a matrix entry x environment with the number of occurence</p></li>
<li><p>"vec_env_with_no_data": a vector with the environments without data for the given variable</p></li>
<li><p>"vec_env_with_no_controls": a vector with the environments with no controls</p></li>
<li><p>"data_env_with_no_controls": a dataframe with the data from environments without controls.</p></li>
<li><p>"vec_env_with_controls": a vector with the environments with controls</p></li>
<li><p>"vec_env_RF": a vector with the environments as regional farms (i.e. with at least two blocks)</p></li>
<li><p>"vec_env_SF": a vector with the environments as satellite farms (i.e. with one block)</p></li>
<li><p>"MCMC": a list with the two MCMC chains (mcmc object)</p></li>
<li><p>"epsilon": a vector with the median value of the epsilon_ijk</p></li>
<li><p>"DIC": the DIC value of the model</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This model estimates entry effects (mu_ij), block effects (beta_jk), residuals (epsilon_ijk) and within-environment variance (sigma_j) on each environment. 
An environment is a combinaison of a location and a year.</p>
<p>The variance are taken in an inverse Gamma distribution of parameters nu and rho. 
This model takes into acount all the information on the network in order to cope with 
the high disequilibrium within each environment (i.e. low degree of freedom at the residual in each environment).</p>
<p>More information can be found in the book : https://priviere.github.io/PPBstats_book/family-1.html#model-1</p>
<p>For DIC value, see ?<code>dic.samples</code> from the <code>rjags</code> package for more information.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>P. Riviere, J.C. Dawson, I. Goldringer, and O. David. Hierarchical Bayesian Modeling for Flexible Experiments in Decentralized Participatory Plant Breeding. Crop Science, 55, 2015.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>
<ul>
<li><p><code><a href='check_model.html'>check_model</a></code></p></li>
<li><p><code><a href='check_model.fit_model_bh_intra_location.html'>check_model.fit_model_bh_intra_location</a></code></p></li>
</ul>
</div>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Pierre Riviere.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


