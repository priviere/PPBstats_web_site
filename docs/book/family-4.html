<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.8 Family 4 of analysis : specific research questions on one farm or more | PPBstats : An R package for Participatory Plant Breeding statisticial analyses</title>
  <meta name="description" content="Tutorial on how to use the R package PPBstats." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="3.8 Family 4 of analysis : specific research questions on one farm or more | PPBstats : An R package for Participatory Plant Breeding statisticial analyses" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Tutorial on how to use the R package PPBstats." />
  <meta name="github-repo" content="priviere/PPBstats" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.8 Family 4 of analysis : specific research questions on one farm or more | PPBstats : An R package for Participatory Plant Breeding statisticial analyses" />
  
  <meta name="twitter:description" content="Tutorial on how to use the R package PPBstats." />
  

<meta name="author" content="Pierre Rivière" />


<meta name="date" content="2021-07-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="family-3.html">
<link rel="next" href="family-5.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../index.html" >PPBstats website</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li><a href="authors-and-contributors-of-ppbstats-and-the-book.html#authors-and-contributors-of-ppbstats-and-the-book">Authors and contributors of <code>PPBstats</code> and the book</a></li>
<li class="chapter" data-level="" data-path="copyright-licence-citation.html"><a href="copyright-licence-citation.html"><i class="fa fa-check"></i>Copyright, Licence, citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="philo.html"><a href="philo.html"><i class="fa fa-check"></i><b>1</b> Philosophy of PPBstats</a><ul>
<li class="chapter" data-level="1.1" data-path="what-is-participatory-plant-bredding.html"><a href="what-is-participatory-plant-bredding.html"><i class="fa fa-check"></i><b>1.1</b> What is Participatory Plant Bredding ?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="what-is-participatory-plant-bredding.html"><a href="what-is-participatory-plant-bredding.html#decentralize-the-selection"><i class="fa fa-check"></i><b>1.1.1</b> Decentralize the selection</a></li>
<li class="chapter" data-level="1.1.2" data-path="what-is-participatory-plant-bredding.html"><a href="what-is-participatory-plant-bredding.html#involve-all-actors-in-the-breeding-decision-process"><i class="fa fa-check"></i><b>1.1.2</b> Involve all actors in the breeding decision process</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="objectives-of-ppbstats.html"><a href="objectives-of-ppbstats.html"><i class="fa fa-check"></i><b>1.2</b> Objectives of <code>PPBstats</code></a></li>
<li class="chapter" data-level="1.3" data-path="contribute.html"><a href="contribute.html"><i class="fa fa-check"></i><b>1.3</b> Contribute</a></li>
<li class="chapter" data-level="1.4" data-path="design-and-statistical-methods-according-to-the-objectives.html"><a href="design-and-statistical-methods-according-to-the-objectives.html"><i class="fa fa-check"></i><b>1.4</b> Design and statistical methods according to the objectives</a></li>
<li class="chapter" data-level="1.5" data-path="lets-go-install-ppbstats-and-the-data-used-in-the-book.html"><a href="lets-go-install-ppbstats-and-the-data-used-in-the-book.html"><i class="fa fa-check"></i><b>1.5</b> Let’s go: install <code>PPBstats</code> and the data used in the book!</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="network.html"><a href="network.html"><i class="fa fa-check"></i><b>2</b> Analysis of network seed circulation (<strong>M8</strong>)</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#workflow-and-function-relations-in-ppbstats-regarding-network-analysis"><i class="fa fa-check"></i><b>2.1.1</b> Workflow and function relations in <code>PPBstats</code> regarding network analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="unipart-network-for-seed-lots-analysis.html"><a href="unipart-network-for-seed-lots-analysis.html"><i class="fa fa-check"></i><b>2.2</b> Unipart network for seed lots analysis</a><ul>
<li class="chapter" data-level="2.2.1" data-path="unipart-network-for-seed-lots-analysis.html"><a href="unipart-network-for-seed-lots-analysis.html#steps-with-ppbstats"><i class="fa fa-check"></i><b>2.2.1</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="2.2.2" data-path="unipart-network-for-seed-lots-analysis.html"><a href="unipart-network-for-seed-lots-analysis.html#format-the-data"><i class="fa fa-check"></i><b>2.2.2</b> Format the data</a></li>
<li class="chapter" data-level="2.2.3" data-path="unipart-network-for-seed-lots-analysis.html"><a href="unipart-network-for-seed-lots-analysis.html#describe-the-data"><i class="fa fa-check"></i><b>2.2.3</b> Describe the data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="unipart-network-for-location-analysis.html"><a href="unipart-network-for-location-analysis.html"><i class="fa fa-check"></i><b>2.3</b> Unipart network for location analysis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="unipart-network-for-location-analysis.html"><a href="unipart-network-for-location-analysis.html#steps-with-ppbstats-1"><i class="fa fa-check"></i><b>2.3.1</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="unipart-network-for-location-analysis.html"><a href="unipart-network-for-location-analysis.html#format-the-data-1"><i class="fa fa-check"></i><b>2.3.2</b> Format the data</a></li>
<li class="chapter" data-level="2.3.3" data-path="unipart-network-for-location-analysis.html"><a href="unipart-network-for-location-analysis.html#format-and-describe-the-data-for-each-germplasm"><i class="fa fa-check"></i><b>2.3.3</b> Format and describe the data for each germplasm</a></li>
<li class="chapter" data-level="2.3.4" data-path="unipart-network-for-location-analysis.html"><a href="unipart-network-for-location-analysis.html#format-and-describe-the-data-for-each-year"><i class="fa fa-check"></i><b>2.3.4</b> Format and describe the data for each year</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bipart-network-analysis.html"><a href="bipart-network-analysis.html"><i class="fa fa-check"></i><b>2.4</b> Bipart network analysis</a><ul>
<li class="chapter" data-level="2.4.1" data-path="bipart-network-analysis.html"><a href="bipart-network-analysis.html#steps-with-ppbstats-2"><i class="fa fa-check"></i><b>2.4.1</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="bipart-network-analysis.html"><a href="bipart-network-analysis.html#format-the-data-2"><i class="fa fa-check"></i><b>2.4.2</b> Format the data</a></li>
<li class="chapter" data-level="2.4.3" data-path="bipart-network-analysis.html"><a href="bipart-network-analysis.html#describe-the-data-1"><i class="fa fa-check"></i><b>2.4.3</b> Describe the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="agronomic.html"><a href="agronomic.html"><i class="fa fa-check"></i><b>3</b> Analysis of agronomic traits</a><ul>
<li class="chapter" data-level="3.1" data-path="intro-agro.html"><a href="intro-agro.html"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="intro-agro.html"><a href="intro-agro.html#objective-agro"><i class="fa fa-check"></i><b>3.1.1</b> Analysis according to the objectives</a></li>
<li class="chapter" data-level="3.1.2" data-path="intro-agro.html"><a href="intro-agro.html#family-analysis-agro"><i class="fa fa-check"></i><b>3.1.2</b> Family of analyses</a></li>
<li class="chapter" data-level="3.1.3" data-path="intro-agro.html"><a href="intro-agro.html#expe-design"><i class="fa fa-check"></i><b>3.1.3</b> Experimental design</a></li>
<li class="chapter" data-level="3.1.4" data-path="intro-agro.html"><a href="intro-agro.html#decision-tree"><i class="fa fa-check"></i><b>3.1.4</b> Decision tree</a></li>
<li class="chapter" data-level="3.1.5" data-path="intro-agro.html"><a href="intro-agro.html#workflow-agro"><i class="fa fa-check"></i><b>3.1.5</b> Workflow and function relations in <code>PPBstats</code> regarding agronomic analysis</a></li>
<li class="chapter" data-level="3.1.6" data-path="intro-agro.html"><a href="intro-agro.html#data-agro"><i class="fa fa-check"></i><b>3.1.6</b> Data format</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="doe.html"><a href="doe.html"><i class="fa fa-check"></i><b>3.2</b> Design the experiment</a><ul>
<li class="chapter" data-level="3.2.1" data-path="doe.html"><a href="doe.html#fully-replicated"><i class="fa fa-check"></i><b>3.2.1</b> Fully-replicated (<strong>D1</strong>)</a></li>
<li class="chapter" data-level="3.2.2" data-path="doe.html"><a href="doe.html#ibd"><i class="fa fa-check"></i><b>3.2.2</b> Incomplete Block Design (<strong>D2</strong>)</a></li>
<li class="chapter" data-level="3.2.3" data-path="doe.html"><a href="doe.html#row-column"><i class="fa fa-check"></i><b>3.2.3</b> Row-column (<strong>D3</strong>)</a></li>
<li class="chapter" data-level="3.2.4" data-path="doe.html"><a href="doe.html#rf-sf"><i class="fa fa-check"></i><b>3.2.4</b> Regional and satellite farms (<strong>D4</strong>)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sow.html"><a href="sow.html"><i class="fa fa-check"></i><b>3.3</b> Sow, note, harvest, measure …</a></li>
<li class="chapter" data-level="3.4" data-path="describe-data-agro.html"><a href="describe-data-agro.html"><i class="fa fa-check"></i><b>3.4</b> Describe the data</a><ul>
<li class="chapter" data-level="3.4.1" data-path="describe-data-agro.html"><a href="describe-data-agro.html#format-the-data-3"><i class="fa fa-check"></i><b>3.4.1</b> Format the data</a></li>
<li class="chapter" data-level="3.4.2" data-path="describe-data-agro.html"><a href="describe-data-agro.html#presence-abscence-matrix"><i class="fa fa-check"></i><b>3.4.2</b> presence abscence matrix</a></li>
<li class="chapter" data-level="3.4.3" data-path="describe-data-agro.html"><a href="describe-data-agro.html#histogramm"><i class="fa fa-check"></i><b>3.4.3</b> histogramm</a></li>
<li class="chapter" data-level="3.4.4" data-path="describe-data-agro.html"><a href="describe-data-agro.html#barplot"><i class="fa fa-check"></i><b>3.4.4</b> barplot</a></li>
<li class="chapter" data-level="3.4.5" data-path="describe-data-agro.html"><a href="describe-data-agro.html#boxplot"><i class="fa fa-check"></i><b>3.4.5</b> boxplot</a></li>
<li class="chapter" data-level="3.4.6" data-path="describe-data-agro.html"><a href="describe-data-agro.html#interaction"><i class="fa fa-check"></i><b>3.4.6</b> interaction</a></li>
<li class="chapter" data-level="3.4.7" data-path="describe-data-agro.html"><a href="describe-data-agro.html#biplot"><i class="fa fa-check"></i><b>3.4.7</b> biplot</a></li>
<li class="chapter" data-level="3.4.8" data-path="describe-data-agro.html"><a href="describe-data-agro.html#radar"><i class="fa fa-check"></i><b>3.4.8</b> radar</a></li>
<li class="chapter" data-level="3.4.9" data-path="describe-data-agro.html"><a href="describe-data-agro.html#raster"><i class="fa fa-check"></i><b>3.4.9</b> raster</a></li>
<li class="chapter" data-level="3.4.10" data-path="describe-data-agro.html"><a href="describe-data-agro.html#map"><i class="fa fa-check"></i><b>3.4.10</b> map</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="family-1.html"><a href="family-1.html"><i class="fa fa-check"></i><b>3.5</b> Family 1 of analysis : Compare different varieties evaluated for selection in different locations.</a><ul>
<li class="chapter" data-level="3.5.1" data-path="family-1.html"><a href="family-1.html#decision-tree-1"><i class="fa fa-check"></i><b>3.5.1</b> Decision tree</a></li>
<li class="chapter" data-level="3.5.2" data-path="family-1.html"><a href="family-1.html#workflow-and-function-relations-in-ppbstats-regarding-family-1-of-analysis"><i class="fa fa-check"></i><b>3.5.2</b> Workflow and function relations in <code>PPBstats</code> regarding family 1 of analysis</a></li>
<li class="chapter" data-level="3.5.3" data-path="family-1.html"><a href="family-1.html#classic-anova"><i class="fa fa-check"></i><b>3.5.3</b> Classic ANOVA (<strong>M4a</strong>)</a></li>
<li class="chapter" data-level="3.5.4" data-path="family-1.html"><a href="family-1.html#spatial-analysis"><i class="fa fa-check"></i><b>3.5.4</b> Spatial analysis (<strong>M4b</strong>)</a></li>
<li class="chapter" data-level="3.5.5" data-path="family-1.html"><a href="family-1.html#ibd-model"><i class="fa fa-check"></i><b>3.5.5</b> Mixted model for incomplete block design (<strong>M5</strong>)</a></li>
<li class="chapter" data-level="3.5.6" data-path="family-1.html"><a href="family-1.html#model-1"><i class="fa fa-check"></i><b>3.5.6</b> Hierarchical Bayesian intra-location model to perform mean comparisons with each farm (<strong>M7a</strong>)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="family-2.html"><a href="family-2.html"><i class="fa fa-check"></i><b>3.6</b> Family 2 of analysis : Study the response of varieties under selection over several environments</a><ul>
<li class="chapter" data-level="3.6.1" data-path="family-2.html"><a href="family-2.html#decision-tree-2"><i class="fa fa-check"></i><b>3.6.1</b> Decision tree</a></li>
<li class="chapter" data-level="3.6.2" data-path="family-2.html"><a href="family-2.html#workflow-and-function-relations-in-ppbstats-regarding-family-2-of-analysis"><i class="fa fa-check"></i><b>3.6.2</b> Workflow and function relations in <code>PPBstats</code> regarding family 2 of analysis</a></li>
<li class="chapter" data-level="3.6.3" data-path="family-2.html"><a href="family-2.html#ammi"><i class="fa fa-check"></i><b>3.6.3</b> AMMI (<strong>M6a</strong>)</a></li>
<li class="chapter" data-level="3.6.4" data-path="family-2.html"><a href="family-2.html#gge"><i class="fa fa-check"></i><b>3.6.4</b> GGE (<strong>M6b</strong>)</a></li>
<li class="chapter" data-level="3.6.5" data-path="family-2.html"><a href="family-2.html#model-2"><i class="fa fa-check"></i><b>3.6.5</b> Hierarchical Bayesian <span class="math inline">\(G \times E\)</span> model to analyse <span class="math inline">\(G \times E\)</span> interaction in the network of farms (<strong>M7b</strong>)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="family-3.html"><a href="family-3.html"><i class="fa fa-check"></i><b>3.7</b> Family 3 of analysis : effects from family 1 and 2 in a network of farms</a><ul>
<li class="chapter" data-level="3.7.1" data-path="family-3.html"><a href="family-3.html#model-3"><i class="fa fa-check"></i><b>3.7.1</b> model 3</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="family-4.html"><a href="family-4.html"><i class="fa fa-check"></i><b>3.8</b> Family 4 of analysis : specific research questions on one farm or more</a><ul>
<li class="chapter" data-level="3.8.1" data-path="family-4.html"><a href="family-4.html#response-to-selection"><i class="fa fa-check"></i><b>3.8.1</b> Study reponse to selection</a></li>
<li class="chapter" data-level="3.8.2" data-path="family-4.html"><a href="family-4.html#study-local-adaptation"><i class="fa fa-check"></i><b>3.8.2</b> Study local adaptation</a></li>
<li class="chapter" data-level="3.8.3" data-path="family-4.html"><a href="family-4.html#variance-intra"><i class="fa fa-check"></i><b>3.8.3</b> Study variance within germplasm</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="family-5.html"><a href="family-5.html"><i class="fa fa-check"></i><b>3.9</b> Family 5 of analysis : multivariate analysis</a><ul>
<li class="chapter" data-level="3.9.1" data-path="family-5.html"><a href="family-5.html#decision-tree-3"><i class="fa fa-check"></i><b>3.9.1</b> Decision tree</a></li>
<li class="chapter" data-level="3.9.2" data-path="family-5.html"><a href="family-5.html#workflow-and-function-relations-in-ppbstats-regarding-family-2-of-analysis-1"><i class="fa fa-check"></i><b>3.9.2</b> Workflow and function relations in <code>PPBstats</code> regarding family 2 of analysis</a></li>
<li class="chapter" data-level="3.9.3" data-path="family-5.html"><a href="family-5.html#steps-with-ppbstats-12"><i class="fa fa-check"></i><b>3.9.3</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="3.9.4" data-path="family-5.html"><a href="family-5.html#format-the-data-11"><i class="fa fa-check"></i><b>3.9.4</b> Format the data</a></li>
<li class="chapter" data-level="3.9.5" data-path="family-5.html"><a href="family-5.html#look-at-correlation"><i class="fa fa-check"></i><b>3.9.5</b> Look at correlation</a></li>
<li class="chapter" data-level="3.9.6" data-path="family-5.html"><a href="family-5.html#run-the-analysis"><i class="fa fa-check"></i><b>3.9.6</b> Run the analysis</a></li>
<li class="chapter" data-level="3.9.7" data-path="family-5.html"><a href="family-5.html#check-outputs-and-results"><i class="fa fa-check"></i><b>3.9.7</b> Check outputs and results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="organoleptic.html"><a href="organoleptic.html"><i class="fa fa-check"></i><b>4</b> Sensory analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="intro-organo.html"><a href="intro-organo.html"><i class="fa fa-check"></i><b>4.1</b> Introduction</a><ul>
<li class="chapter" data-level="4.1.1" data-path="intro-organo.html"><a href="intro-organo.html#objective-organo"><i class="fa fa-check"></i><b>4.1.1</b> Analysis according to the objectives</a></li>
<li class="chapter" data-level="4.1.2" data-path="intro-organo.html"><a href="intro-organo.html#decision-tree-organo"><i class="fa fa-check"></i><b>4.1.2</b> Decision tree</a></li>
<li class="chapter" data-level="4.1.3" data-path="intro-organo.html"><a href="intro-organo.html#workflow-organo"><i class="fa fa-check"></i><b>4.1.3</b> Workflow and function relations in <code>PPBstats</code> regarding organoleptic analysis</a></li>
<li class="chapter" data-level="4.1.4" data-path="intro-organo.html"><a href="intro-organo.html#data-organo"><i class="fa fa-check"></i><b>4.1.4</b> Data format</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="taste.html"><a href="taste.html"><i class="fa fa-check"></i><b>4.2</b> Taste and measure …</a></li>
<li class="chapter" data-level="4.3" data-path="hedonic.html"><a href="hedonic.html"><i class="fa fa-check"></i><b>4.3</b> Hedonic analysis (<strong>M9b</strong>)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="hedonic.html"><a href="hedonic.html#method-description"><i class="fa fa-check"></i><b>4.3.1</b> Method description</a></li>
<li class="chapter" data-level="4.3.2" data-path="hedonic.html"><a href="hedonic.html#steps-with-ppbstats-13"><i class="fa fa-check"></i><b>4.3.2</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="hedonic.html"><a href="hedonic.html#format-the-data-12"><i class="fa fa-check"></i><b>4.3.3</b> Format the data</a></li>
<li class="chapter" data-level="4.3.4" data-path="hedonic.html"><a href="hedonic.html#describe-the-data-4"><i class="fa fa-check"></i><b>4.3.4</b> Describe the data</a></li>
<li class="chapter" data-level="4.3.5" data-path="hedonic.html"><a href="hedonic.html#run-the-model-9"><i class="fa fa-check"></i><b>4.3.5</b> Run the model</a></li>
<li class="chapter" data-level="4.3.6" data-path="hedonic.html"><a href="hedonic.html#check-and-visualize-model-outputs-9"><i class="fa fa-check"></i><b>4.3.6</b> Check and visualize model outputs</a></li>
<li class="chapter" data-level="4.3.7" data-path="hedonic.html"><a href="hedonic.html#get-and-visualize-mean-comparisons-on-note"><i class="fa fa-check"></i><b>4.3.7</b> Get and visualize mean comparisons on note</a></li>
<li class="chapter" data-level="4.3.8" data-path="hedonic.html"><a href="hedonic.html#get-and-visualize-biplot-regarding-samples-ca-and-juges-hcpc"><i class="fa fa-check"></i><b>4.3.8</b> Get and visualize biplot regarding samples (CA) and juges (HCPC)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="napping.html"><a href="napping.html"><i class="fa fa-check"></i><b>4.4</b> Napping analysis (<strong>M9a</strong>)</a><ul>
<li class="chapter" data-level="4.4.1" data-path="napping.html"><a href="napping.html#method-description-1"><i class="fa fa-check"></i><b>4.4.1</b> Method description</a></li>
<li class="chapter" data-level="4.4.2" data-path="napping.html"><a href="napping.html#steps-with-ppbstats-14"><i class="fa fa-check"></i><b>4.4.2</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="4.4.3" data-path="napping.html"><a href="napping.html#format-the-data-13"><i class="fa fa-check"></i><b>4.4.3</b> Format the data</a></li>
<li class="chapter" data-level="4.4.4" data-path="napping.html"><a href="napping.html#describe-the-data-5"><i class="fa fa-check"></i><b>4.4.4</b> Describe the data</a></li>
<li class="chapter" data-level="4.4.5" data-path="napping.html"><a href="napping.html#run-the-model-10"><i class="fa fa-check"></i><b>4.4.5</b> Run the model</a></li>
<li class="chapter" data-level="4.4.6" data-path="napping.html"><a href="napping.html#check-and-visualize-model-outputs-10"><i class="fa fa-check"></i><b>4.4.6</b> Check and visualize model outputs</a></li>
<li class="chapter" data-level="4.4.7" data-path="napping.html"><a href="napping.html#get-and-visualize-biplot-2"><i class="fa fa-check"></i><b>4.4.7</b> Get and visualize biplot</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="rank.html"><a href="rank.html"><i class="fa fa-check"></i><b>4.5</b> Rank analysis (<strong>M9c</strong>)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="rank.html"><a href="rank.html#method-description-2"><i class="fa fa-check"></i><b>4.5.1</b> Method description</a></li>
<li class="chapter" data-level="4.5.2" data-path="rank.html"><a href="rank.html#steps-with-ppbstats-15"><i class="fa fa-check"></i><b>4.5.2</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="rank.html"><a href="rank.html#format-the-data-14"><i class="fa fa-check"></i><b>4.5.3</b> Format the data</a></li>
<li class="chapter" data-level="4.5.4" data-path="rank.html"><a href="rank.html#run-the-model-11"><i class="fa fa-check"></i><b>4.5.4</b> Run the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="molecular.html"><a href="molecular.html"><i class="fa fa-check"></i><b>5</b> Molecular analysis (<strong>M3</strong>)</a></li>
<li class="chapter" data-level="6" data-path="com.html"><a href="com.html"><i class="fa fa-check"></i><b>6</b> Communicate results to farmers</a><ul>
<li class="chapter" data-level="6.1" data-path="com-technic.html"><a href="com-technic.html"><i class="fa fa-check"></i><b>6.1</b> Technical aspects</a><ul>
<li class="chapter" data-level="6.1.1" data-path="com-technic.html"><a href="com-technic.html#run-the-analysis-1"><i class="fa fa-check"></i><b>6.1.1</b> Run the analysis</a></li>
<li class="chapter" data-level="6.1.2" data-path="com-technic.html"><a href="com-technic.html#create-a-.rmd-template"><i class="fa fa-check"></i><b>6.1.2</b> Create a <code>.Rmd</code> template</a></li>
<li class="chapter" data-level="6.1.3" data-path="com-technic.html"><a href="com-technic.html#generate-a-report-for-each-location"><i class="fa fa-check"></i><b>6.1.3</b> Generate a report for each location</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="com-rules.html"><a href="com-rules.html"><i class="fa fa-check"></i><b>6.2</b> Organisational aspects on collective work</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="acknowledgement.html"><a href="acknowledgement.html"><i class="fa fa-check"></i>Acknowledgement</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="../index.html" target="_blank">PPBstats website</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><code>PPBstats</code> : An <code>R</code> package for Participatory Plant Breeding statisticial analyses</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="family-4" class="section level2">
<h2><span class="header-section-number">3.8</span> Family 4 of analysis : specific research questions on one farm or more</h2>
<p>In this section, several models are proposed for specific research questions:</p>
<ul>
<li>Study response to selection (section <a href="family-4.html#response-to-selection">3.8.1</a>) based on models from Family 1 of analysis presented in section <a href="family-1.html#family-1">3.5</a></li>
<li>Study local adaptation with two models: home away (section <a href="family-4.html#home-away">3.8.2.2</a>) and local foreign (section <a href="family-4.html#local-foreign">3.8.2.3</a>) based on fully-replicated design (<strong>D1</strong>) (section <a href="doe.html#fully-replicated">3.2.1</a>)</li>
<li>Study intra germplasm variance with a dedicated model (section <a href="family-4.html#variance-intra">3.8.3</a>)</li>
</ul>

<div id="response-to-selection" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Study reponse to selection</h3>
<p>For a given trait, selection differential corresponds to the difference between mean of the selected spikes and
mean of the bulk (i.e. spikes that have not been selected).
Response to selection correponds to the difference between mean of spikes coming from the selected spikes and the spikes coming from the bulk (Figure <a href="family-4.html#fig:SR">3.26</a>).
Selection differential (<span class="math inline">\(S\)</span>) and response to selection (<span class="math inline">\(R\)</span>) are linked with the realized heritability (<span class="math inline">\(h^2_r\)</span>):
<span class="math inline">\(R = h^2_r \times S\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:SR"></span>
<img src="figures/SandR_EN-7.png" alt="Seletion differential (S) in 2014-2015 and response to selection (R) in 2015-2016. Circles and arrows in gray represent the seed-lots that have been sown in 2015 after harvest in 2015.[@SandR_EN]" width="80%" />
<p class="caption">
Figure 3.26: Seletion differential (S) in 2014-2015 and response to selection (R) in 2015-2016. Circles and arrows in gray represent the seed-lots that have been sown in 2015 after harvest in 2015.<span class="citation">(Rivière <a href="#ref-SandR_EN">2015</a>)</span>
</p>
</div>
<div id="workflow-and-function-relations-in-ppbstats-regarding-response-to-selection-analysis" class="section level4">
<h4><span class="header-section-number">3.8.1.1</span> Workflow and function relations in PPBstats regarding response to selection analysis</h4>
<p>Figure <a href="family-4.html#fig:main-workflow-family-4-SR">3.27</a> displays the functions and their relationships.
Table <a href="family-4.html#tab:function-descriptions-workflow-family-4-SR">3.4</a> describes each of the main functions.</p>
<p>You can have more information for each function by typing <code>?function_name</code> in your R session.</p>
<div class="figure" style="text-align: center"><span id="fig:main-workflow-family-4-SR"></span>
<img src="figures/main-functions-agro-family-4-SR.png" alt="Main functions used in the workflow to study response to selection." width="90%" />
<p class="caption">
Figure 3.27: Main functions used in the workflow to study response to selection.
</p>
</div>
<table>
<caption><span id="tab:function-descriptions-workflow-family-4-SR">Table 3.4: </span> Function description.</caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>function name</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>design_experiment</code></td>
<td>Provides experimental design for the different situations corresponding to the choosen family of analysis</td>
</tr>
<tr class="even">
<td><code>format_data_PPBstats</code></td>
<td>Check and format the data to be used in <code>PPBstats</code> functions</td>
</tr>
<tr class="odd">
<td><code>plot</code></td>
<td>Build ggplot objects to visualize output</td>
</tr>
</tbody>
</table>
</div>
<div id="steps-with-ppbstats-8" class="section level4">
<h4><span class="header-section-number">3.8.1.2</span> Steps with PPBstats</h4>
<p>To study response to selection, you can follow three steps (Figure <a href="family-4.html#fig:main-workflow-family-4-SR">3.27</a>):</p>
<ul>
<li>Format the data with <code>format_data_PPBstats()</code></li>
<li>Describe the data with <code>plot()</code></li>
<li>Get mean comparison from family 1’s model as explained in section <a href="family-1.html#family-1">3.5</a> by
<ul>
<li>running the model</li>
<li>get mean comparisons</li>
<li>use <code>plot()</code></li>
</ul></li>
</ul>
</div>
<div id="format-data" class="section level4">
<h4><span class="header-section-number">3.8.1.3</span> Format data</h4>
<p>In this section, the data set used is coming from <code>data_model_GxE</code> (section <a href="family-2.html#ammi">3.6.3</a>) with three dedicated columns:</p>
<ul>
<li><code>group</code> which represents differential selection (S) or reponse to selection (R)</li>
<li><code>version</code> which represents bouquet or vrac.</li>
<li><code>expe_id</code>: an id with
<ul>
<li>S couple and R couple (i.e. four rows) OR</li>
<li>S couple (i.e. two rows) OR</li>
<li>R couple (i.e. two rows)</li>
</ul></li>
</ul>
<p><code>expe_id</code> is useful for example if there are several selection in one germplasm or if there are several origin for a given germplasm.</p>
</div>
<div id="describe-and-get-mean-comparison-from-family-1s-model" class="section level4">
<h4><span class="header-section-number">3.8.1.4</span> Describe and get mean comparison from family 1’s model</h4>
<p>For all model, stars on a pair of entries corresponds to the pvalue:</p>
<table>
<thead>
<tr class="header">
<th>pvalue</th>
<th>stars</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(&lt; 0.001\)</span></td>
<td>***</td>
</tr>
<tr class="even">
<td><span class="math inline">\([0.001 , 0.05]\)</span></td>
<td>**</td>
</tr>
<tr class="odd">
<td><span class="math inline">\([0.05 , 0.01]\)</span></td>
<td>*</td>
</tr>
<tr class="even">
<td><span class="math inline">\(&gt; 0.01\)</span></td>
<td>.</td>
</tr>
</tbody>
</table>
<div id="classic-anova-model" class="section level5">
<h5><span class="header-section-number">3.8.1.4.1</span> Classic anova model</h5>
<p>To Do !!!</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#data(data_agro_SR_1)</span>
<span class="co">#data_agro_SR_1 = format_data_PPBstats(data_agro_SR_1, type = &quot;data_agro_SR&quot;)</span></code></pre>
</div>
<div id="spatial-analysis-model" class="section level5">
<h5><span class="header-section-number">3.8.1.4.2</span> Spatial analysis model</h5>
<p>To Do !!!</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#data(data_agro_SR_2)</span>
<span class="co">#data_agro_SR_2 = format_data_PPBstats(data_agro_SR_2, type = &quot;data_agro_SR&quot;)</span></code></pre>
</div>
<div id="mixed-model-for-incomplete-block-design" class="section level5">
<h5><span class="header-section-number">3.8.1.4.3</span> Mixed model for incomplete block design</h5>
<p>To Do !!!</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#data(data_agro_SR_3)</span>
<span class="co">#data_agro_SR_3 = format_data_PPBstats(data_agro_SR_3, type = &quot;data_agro_SR&quot;)</span></code></pre>
</div>
<div id="hierarchical-bayesian-intra-location-model" class="section level5">
<h5><span class="header-section-number">3.8.1.4.4</span> Hierarchical Bayesian intra-location model</h5>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(data_agro_SR_<span class="dv">4</span>)
data_agro_SR_<span class="dv">4</span> =<span class="st"> </span><span class="kw">format_data_PPBstats</span>(data_agro_SR_<span class="dv">4</span>, <span class="dt">type =</span> <span class="st">&quot;data_agro_SR&quot;</span>)</code></pre>
<pre><code>## Warning in format_data_PPBstats.data_agro(data): Column &quot;long&quot; is needed to
## get map and not present in data.</code></pre>
<pre><code>## Warning in format_data_PPBstats.data_agro(data): Column &quot;lat&quot; is needed to
## get map and not present in data.</code></pre>
<pre><code>## data has been formated for PPBstats functions.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(data_agro_SR_<span class="dv">4</span>)</code></pre>
<pre><code>##                  seed_lot location year germplasm block X Y expe_id group
## 1 germ-25_loc-1_2005_0001    loc-1 2005   germ-25     1 1 a    id_1     S
## 2 germ-26_loc-1_2005_0001    loc-1 2005   germ-26     1 2 b    id_1     S
## 3 germ-27_loc-1_2005_0001    loc-1 2005   germ-27     1 3 c    id_1     R
## 4 germ-28_loc-1_2005_0001    loc-1 2005   germ-28     1 4 d    id_1     R
## 5 germ-25_loc-1_2005_0001    loc-1 2005   germ-25     2 5 e    id_2     S
## 6 germ-26_loc-1_2005_0001    loc-1 2005   germ-26     2 6 f    id_2     S
##   version      tkw   tkw$date tkw$date_julian
## 1 bouquet 72.09900 2017-07-22             202
## 2    vrac 61.05274 2017-07-22             202
## 3 bouquet 62.99350 2017-07-22             202
## 4    vrac 65.10909 2017-07-22             202
## 5 bouquet 77.01361 2017-07-22             202
## 6    vrac 64.10541 2017-07-22             202</code></pre>
<p>First, describe the data.</p>
<pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span><span class="kw">plot</span>(data_agro_SR_<span class="dv">4</span>, <span class="dt">vec_variables =</span> <span class="st">&quot;tkw&quot;</span>, <span class="dt">plot_type =</span> <span class="st">&quot;barplot&quot;</span>)</code></pre>
<pre><code>## Regarding post_hoc analysis, 2 couples S and R are displayed. 5 S without corresponding R or R without corresponding S are not displayed.</code></pre>
<p>The plot has two lists:
- one for each id where each element of the list is an <code>expe_id</code>.
- one on post hoc analysis with all couple S (election differential) and R (response to selection) where each element of the list refer to germplasm, location or year</p>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>tkw<span class="op">$</span>analysis_for_each_id<span class="op">$</span>id_<span class="dv">1</span></code></pre>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_errorbar).</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-280-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>tkw<span class="op">$</span>post_hoc_analysis<span class="op">$</span>germplasm</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
<p>In addition, the realized heritability (<span class="math inline">\(h^2_r\)</span>: <span class="math inline">\(R = h^2_r \times S\)</span>) can be displayed.</p>
<pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span><span class="kw">plot</span>(data_agro_SR_<span class="dv">4</span>, <span class="dt">vec_variables =</span> <span class="st">&quot;tkw&quot;</span>, <span class="dt">plot_type =</span> <span class="st">&quot;barplot&quot;</span>, <span class="dt">heritability =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>## Regarding post_hoc analysis, 2 couples S and R are displayed. 5 S without corresponding R or R without corresponding S are not displayed.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>tkw<span class="op">$</span>analysis_for_each_id<span class="op">$</span>id_<span class="dv">1</span></code></pre>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_errorbar).</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>tkw<span class="op">$</span>post_hoc_analysis<span class="op">$</span>germplasm</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-284-1.png" width="672" /></p>
<p>In order to add significance differences from the Hierarchical Bayesian intra-location model presented in section <a href="family-1.html#model-1">3.5.6</a>, the argument <code>mean_comparisons</code> must be filled with the output of mean_comparisons of the model.</p>
<p>The pvalue is computed as describe in Section <a href="intro-agro.html#mean-comp-bayes">3.1.2.2.3</a> if the parameters have been estimated with the model.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;./data_PPBstats/out_mean_comparisons_model_bh_intra_location_mu.RData&quot;</span>) <span class="co"># To save time</span>
p =<span class="st"> </span><span class="kw">plot</span>(data_agro_SR_<span class="dv">4</span>,
         <span class="dt">mean_comparison =</span> out_mean_comparisons_model_bh_intra_location_mu, 
         <span class="dt">vec_variables =</span> <span class="st">&quot;tkw&quot;</span>,
         <span class="dt">plot_type =</span> <span class="st">&quot;barplot&quot;</span>)</code></pre>
<pre><code>## Regarding post_hoc analysis, 2 couples S and R are displayed. 5 S without corresponding R or R without corresponding S are not displayed.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>tkw<span class="op">$</span>analysis_for_each_id<span class="op">$</span>id_<span class="dv">1</span></code></pre>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_errorbar).</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
<p>For environments where MCMC did not converge or without environments, it is a @ref(t.test) which is perform when there are more than 1 obervation for a given seed lot.</p>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>tkw<span class="op">$</span>analysis_for_each_id<span class="op">$</span>id_<span class="dv">1</span></code></pre>
<pre><code>## Warning: Removed 4 rows containing missing values (geom_errorbar).</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-286-1.png" width="672" /></p>
<p>By setting <code>heritability = TRUE</code>, the realized heritability is displayed.</p>

</div>
</div>
</div>
<div id="study-local-adaptation" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Study local adaptation</h3>
<div id="workflow-and-function-relations-in-ppbstats-regarding-local-adaptation-analysis" class="section level4">
<h4><span class="header-section-number">3.8.2.1</span> Workflow and function relations in PPBstats regarding local adaptation analysis</h4>
<p>Figure <a href="family-4.html#fig:main-workflow-family-4-HALF">3.28</a> displays the functions and their relationships.
Table <a href="family-4.html#tab:function-descriptions-workflow-family-4-HALF">3.5</a> describes each of the main functions.</p>
<p>You can have more information for each function by typing <code>?function_name</code> in your R session.
Note that <code>check_model()</code>, <code>mean_comparison()</code> and <code>plot()</code> are S3 method.
Therefore, you should type <code>?check_model</code>, <code>?mean_comparison</code> or <code>?plot.PPBstats</code> to have general features and then see in details for specific functions.</p>
<div class="figure" style="text-align: center"><span id="fig:main-workflow-family-4-HALF"></span>
<img src="figures/main-functions-agro-family-4-HALF.png" alt="Main functions used in the workflow to study local adaptation." width="90%" />
<p class="caption">
Figure 3.28: Main functions used in the workflow to study local adaptation.
</p>
</div>
<table>
<caption><span id="tab:function-descriptions-workflow-family-4-HALF">Table 3.5: </span> Function description.</caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>function name</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>design_experiment</code></td>
<td>Provides experimental design for the different situations corresponding to the choosen family of analysis</td>
</tr>
<tr class="even">
<td><code>format_data_PPBstats</code></td>
<td>Check and format the data to be used in <code>PPBstats</code> functions</td>
</tr>
<tr class="odd">
<td><code>HA_to_LF</code></td>
<td>Transform home away data to local foreign data</td>
</tr>
<tr class="even">
<td><code>LF_to_HA</code></td>
<td>Transform local foreign data to home away data</td>
</tr>
<tr class="odd">
<td><code>model_home_away</code></td>
<td>Run home away model</td>
</tr>
<tr class="even">
<td><code>model_local_foreign</code></td>
<td>Run local foreign model</td>
</tr>
<tr class="odd">
<td><code>check_model</code></td>
<td>Check if the model went well</td>
</tr>
<tr class="even">
<td><code>mean_comparisons</code></td>
<td>Get mean comparisons</td>
</tr>
<tr class="odd">
<td><code>plot</code></td>
<td>Build ggplot objects to visualize output</td>
</tr>
</tbody>
</table>
</div>
<div id="home-away" class="section level4">
<h4><span class="header-section-number">3.8.2.2</span> Home away</h4>
<p>Home away analysis allows to study local adaptation.
Away in a location refers to a germplasm that has not been grown or selected in a given location.
Home in a location refers to a germplasm that has been grown or selected in a given location.</p>
<p>The following model take into account germplasm and location effects in order to better study version (home or away) effect <span class="citation">(Blanquart et al. <a href="#ref-blanquart_practical_2013">2013</a>)</span>.
The model is based on frequentist statistics (section <a href="intro-agro.html#section-freq">3.1.2.1</a>).</p>
<p><span class="math inline">\(Y_{ijkm} = \mu + \alpha_i + \theta_j + \omega_{k_{ij}} + (\omega \times \alpha)_{k_{ij}j} + rep(\theta)_{mj} + \varepsilon_{ijkm}; \quad \varepsilon_{ijkm} \sim \mathcal{N} (0,\sigma^2)\)</span></p>
<p>with</p>
<ul>
<li><span class="math inline">\(Y_{ijkm}\)</span> the phenotypic value for replication <span class="math inline">\(m\)</span>, germplasm <span class="math inline">\(i\)</span> and location <span class="math inline">\(j\)</span>, and version <span class="math inline">\(k\)</span>,</li>
<li><span class="math inline">\(\mu\)</span> the general mean,</li>
<li><span class="math inline">\(\alpha_i\)</span> the effect of germplasm <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\(\theta_j\)</span> the effect of location <span class="math inline">\(j\)</span>,</li>
<li><span class="math inline">\(\omega_{k_{ij}}\)</span> the effect of version, home or away for a germplasm <span class="math inline">\(i\)</span> in location <span class="math inline">\(j\)</span>,</li>
<li><span class="math inline">\((\omega \times \theta)_{k_{ij}j}\)</span> the interaction effect of version <span class="math inline">\(\times\)</span> location,</li>
<li><span class="math inline">\(rep(\theta)_{mj}\)</span> the effect of the replication <span class="math inline">\(m\)</span> nested in location,</li>
<li><span class="math inline">\(\varepsilon_{ijkm}\)</span> the residuals.</li>
</ul>
<p>The comparisons of all germplasm in all location in sympatric or allopatric situation (measured by version effect <span class="math inline">\(\omega_{k_{ij}}\)</span>) give a glocal measure of local adaptation <span class="citation">(Blanquart et al. <a href="#ref-blanquart_practical_2013">2013</a>)</span>.
Interaction effect <span class="math inline">\((\omega \times \alpha)_{k_{ij}j}\)</span> give information on specific adaptation to each location.</p>
<p>If there are more than one year, then the model can be written :</p>
<p><span class="math inline">\(Y_{ijklm} = \mu + \alpha_i + \theta_j + \beta_l + \omega_{k_{ij}} + (\theta \times \beta)_{jl} + (\omega \times \alpha)_{k_{ij}j} + rep(\theta \times \beta)_{mjl} + (\omega \times \alpha \times \beta)_{k_{ij}jl} + \varepsilon_{ijklm}; \quad \varepsilon_{ijklm} \sim \mathcal{N} (0,\sigma^2)\)</span></p>
<p>with</p>
<ul>
<li><span class="math inline">\(Y_{ijklm}\)</span> the phenotypic value for replication <span class="math inline">\(m\)</span>, germplasm <span class="math inline">\(i\)</span> and location <span class="math inline">\(j\)</span>, year <span class="math inline">\(l\)</span> and version <span class="math inline">\(k\)</span>,</li>
<li><span class="math inline">\(\mu\)</span> the general mean,</li>
<li><span class="math inline">\(\alpha_i\)</span> the effect of germplasm <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\(\theta_j\)</span> the effect of location <span class="math inline">\(j\)</span>,</li>
<li><span class="math inline">\(\beta_l\)</span> the effect of year <span class="math inline">\(l\)</span>,</li>
<li><span class="math inline">\(\omega_{k_{ij}}\)</span> the effect of version, home or away for a germplasm <span class="math inline">\(i\)</span> in location <span class="math inline">\(j\)</span>,</li>
<li><span class="math inline">\((\theta \times \beta)_{jl}\)</span> the interaction effect of location <span class="math inline">\(\times\)</span> year,</li>
<li><span class="math inline">\((\omega \times \theta)_{k_{ij}j}\)</span> the interaction effect of version <span class="math inline">\(\times\)</span> location,</li>
<li><span class="math inline">\(rep(\theta \times \beta)_{mjl}\)</span> the effect of the replication <span class="math inline">\(m\)</span> nested in location <span class="math inline">\(\times\)</span> year,</li>
<li><span class="math inline">\((\omega \times \theta \times \beta)_{k_{ij}jl}\)</span> the interaction effect of version <span class="math inline">\(\times\)</span> location <span class="math inline">\(\times\)</span> year,</li>
<li><span class="math inline">\(\varepsilon_{ijklm}\)</span> the residuals.</li>
</ul>
<p>Interaction <span class="math inline">\((\omega \times \theta \times \beta)_{k_{ij}jl}\)</span> give information on specific adaptation to each location for a given year.</p>
<p>A type III anova is done here as the data are not orthogonal.</p>
<div id="steps-with-ppbstats-9" class="section level5">
<h5><span class="header-section-number">3.8.2.2.1</span> Steps with <code>PPBstats</code></h5>
<p>For home away analysis, you can follow these steps (Figure <a href="family-4.html#fig:main-workflow-family-4-HALF">3.28</a>):</p>
<ul>
<li>Format the data with <code>format_data_PPBstats()</code></li>
<li>describe the data with <code>plot()</code></li>
<li>Run the model with <code>model_home_away()</code></li>
<li>Check model outputs with graphs to know if you can continue the analysis with <code>check_model()</code> and vizualise it with <code>plot()</code></li>
<li>Get mean comparisons for each factor with <code>mean_comparisons()</code> and vizualise it with <code>plot()</code></li>
</ul>
</div>
<div id="format-data-1" class="section level5">
<h5><span class="header-section-number">3.8.2.2.2</span> Format data</h5>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;data_agro_HA&quot;</span>)
data_agro_HA =<span class="st"> </span><span class="kw">format_data_PPBstats</span>(data_agro_HA, <span class="dt">type =</span> <span class="st">&quot;data_agro_HA&quot;</span>)</code></pre>
<pre><code>## Warning in format_data_PPBstats.data_agro(data): Column &quot;long&quot; is needed to
## get map and not present in data.</code></pre>
<pre><code>## Warning in format_data_PPBstats.data_agro(data): Column &quot;lat&quot; is needed to
## get map and not present in data.</code></pre>
<pre><code>## data has been formated for PPBstats functions.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(data_agro_HA)</code></pre>
<pre><code>##                 seed_lot location year germplasm block X  Y origin version
## 1 germ-1_loc-1_2005_0001    loc-1 2005    germ-1     1 A  2  loc-1    home
## 2 germ-1_loc-1_2005_0001    loc-1 2005    germ-1     2 C  6  loc-1    home
## 3 germ-1_loc-1_2005_0001    loc-1 2005    germ-1     3 B 13  loc-1    home
## 4 germ-2_loc-1_2005_0001    loc-1 2005    germ-2     1 D  5  loc-2    away
## 5 germ-2_loc-1_2005_0001    loc-1 2005    germ-2     2 B  9  loc-2    away
## 6 germ-2_loc-1_2005_0001    loc-1 2005    germ-2     3 C 14  loc-2    away
##         y1    y1$date       y2    y2$date       y3    y3$date
## 1 23.03428 2017-07-15 37.38970 2017-07-15 63.39528 2017-07-15
## 2 17.23622 2017-07-15 42.90576 2017-07-15 66.87962 2017-07-15
## 3 25.33605 2017-07-15 31.87826 2017-07-15 60.63063 2017-07-15
## 4 12.48506 2017-07-15 46.09260 2017-07-15 55.18082 2017-07-15
## 5 13.37886 2017-07-15 46.51270 2017-07-15 51.88016 2017-07-15
## 6 17.64994 2017-07-15 39.96316 2017-07-15 53.13201 2017-07-15
##   y1$date_julian y2$date_julian y3$date_julian
## 1            195            195            195
## 2            195            195            195
## 3            195            195            195
## 4            195            195            195
## 5            195            195            195
## 6            195            195            195</code></pre>
<p>Where <code>version</code> represents away or home and <code>group</code> represents the location where the germplasm come from.</p>
</div>
<div id="describe-the-data-2" class="section level5">
<h5><span class="header-section-number">3.8.2.2.3</span> Describe the data</h5>
<pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span><span class="kw">plot</span>(data_agro_HA, <span class="dt">vec_variables =</span> <span class="st">&quot;y1&quot;</span>, <span class="dt">plot_type =</span> <span class="st">&quot;barplot&quot;</span>)</code></pre>
<p><code>p</code> is a list with as many element as variable.
For each variable, there are three elements :</p>
<ul>
<li>A single plot with version for all germplasm merged</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>y1<span class="op">$</span>home_away_merged</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-289-1.png" width="672" /></p>
<ul>
<li>A single plot with version for each germplasm</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>y1<span class="op">$</span>home_away_merged_per_germplasm</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-290-1.png" width="672" /></p>
<ul>
<li>A list of plots for each germplasm with all version separated</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>y1<span class="op">$</span>home_away_per_germplasm<span class="op">$</span><span class="st">`</span><span class="dt">germ-1</span><span class="st">`</span><span class="op">$</span>version</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-291-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>y1<span class="op">$</span>home_away_per_germplasm<span class="op">$</span><span class="st">`</span><span class="dt">germ-1</span><span class="st">`</span><span class="op">$</span>origin</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-292-1.png" width="672" /></p>
<p>If you have several year in the data, you can set argument <code>f_gris = &quot;year&quot;</code> in order to have plot for each year.
In the example below t is not really relevent beaause there is only one year in the data set!</p>
<pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span><span class="kw">plot</span>(data_agro_HA, <span class="dt">vec_variables =</span> <span class="st">&quot;y1&quot;</span>, <span class="dt">plot_type =</span> <span class="st">&quot;barplot&quot;</span>, <span class="dt">f_grid =</span> <span class="st">&quot;year&quot;</span>)
p<span class="op">$</span>y1<span class="op">$</span>home_away_merged_per_germplasm</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-293-1.png" width="672" /></p>
</div>
<div id="run-the-model-6" class="section level5">
<h5><span class="header-section-number">3.8.2.2.4</span> Run the model</h5>
<p>To run HOME AWAY model on the dataset, use the function <code>model_home_away</code>.
You can run it on one variable.</p>
<pre class="sourceCode r"><code class="sourceCode r">out_ha =<span class="st"> </span><span class="kw">model_home_away</span>(data_agro_HA, <span class="st">&quot;y1&quot;</span>)</code></pre>
<p><code>out_ha</code> is a list containing three elements :</p>
<ul>
<li><code>info</code> : a list with variable</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">out_ha<span class="op">$</span>info</code></pre>
<pre><code>## $variable
## [1] &quot;y1&quot;</code></pre>
<ul>
<li><code>ANOVA</code> a list with five elements :
<ul>
<li><code>model</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">out_ha<span class="op">$</span>ANOVA<span class="op">$</span>model</code></pre>
<pre><code>## 
## Call:
## stats::lm(formula = variable ~ location + germplasm + version + 
##     version:germplasm + location/block, data = data)
## 
## Coefficients:
##                 (Intercept)                locationloc-2  
##                     15.3748                       8.7827  
##               locationloc-3              germplasmgerm-2  
##                      4.2256                      -0.6989  
##             germplasmgerm-3                  versionhome  
##                      4.2563                       6.0237  
## germplasmgerm-2:versionhome  germplasmgerm-3:versionhome  
##                     -5.6698                     -15.4536  
##        locationloc-1:block2         locationloc-2:block2  
##                      0.5964                      -1.8569  
##        locationloc-3:block2         locationloc-1:block3  
##                     -0.4242                       0.8148  
##        locationloc-2:block3         locationloc-3:block3  
##                     -0.3666                      -3.3060</code></pre>
<ul>
<li><code>anova_model</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">out_ha<span class="op">$</span>ANOVA<span class="op">$</span>anova_model</code></pre>
<pre><code>## Anova Table (Type III tests)
## 
## Response: variable
##                   Sum Sq Df F value   Pr(&gt;F)   
## (Intercept)       327.30  1 17.4142 0.001093 **
## location           86.82  2  2.3096 0.138584   
## germplasm          64.74  2  1.7222 0.217027   
## version            43.54  1  2.3167 0.151940   
## germplasm:version 122.23  2  3.2516 0.071605 . 
## location:block     26.28  6  0.2331 0.958038   
## Residuals         244.33 13                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></li>
</ul>
</div>
<div id="check-and-visualize-model-outputs-6" class="section level5">
<h5><span class="header-section-number">3.8.2.2.5</span> Check and visualize model outputs</h5>
<p>The tests to check the model are explained in section <a href="intro-agro.html#check-model-freq">3.1.2.1.2</a>.</p>
<div id="check-the-model-6" class="section level6">
<h6><span class="header-section-number">3.8.2.2.5.1</span> Check the model</h6>
<p>Once the model is run, it is necessary to check if the outputs can be taken with confidence.
This step is needed before going ahead in the analysis (in fact, object used in the next functions must come from <code>check_model()</code>).</p>
<pre class="sourceCode r"><code class="sourceCode r">out_check_ha =<span class="st"> </span><span class="kw">check_model</span>(out_ha)</code></pre>
<p><code>out_check_ha</code> is a list containing four elements :</p>
<ul>
<li><code>model_home_away</code> the output from the model</li>
<li><code>data_ggplot</code> a list containing information for ggplot:
<ul>
<li><code>data_ggplot_residuals</code> a list containing :
<ul>
<li><code>data_ggplot_normality</code></li>
<li><code>data_ggplot_skewness_test</code></li>
<li><code>data_ggplot_kurtosis_test</code></li>
<li><code>data_ggplot_shapiro_test</code></li>
<li><code>data_ggplot_qqplot</code></li>
</ul></li>
<li><code>data_ggplot_variability_repartition_pie</code></li>
<li><code>data_ggplot_var_intra</code></li>
</ul></li>
</ul>
</div>
<div id="visualize-outputs-6" class="section level6">
<h6><span class="header-section-number">3.8.2.2.5.2</span> Visualize outputs</h6>
<p>Once the computation is done, you can visualize the results with <code>plot()</code></p>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_ha =<span class="st"> </span><span class="kw">plot</span>(out_check_ha)</code></pre>
<p><code>p_out_check_ha</code> is a list with:</p>
<ul>
<li><code>residuals</code>
<ul>
<li><code>histogram</code> : histogram with the distribution of the residuals</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_ha<span class="op">$</span>residuals<span class="op">$</span>histogram</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<img src="PPBstats_book_files/figure-html/unnamed-chunk-300-1.png" width="672" />
<ul>
<li><code>qqplot</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_ha<span class="op">$</span>residuals<span class="op">$</span>qqplot</code></pre>
<img src="PPBstats_book_files/figure-html/unnamed-chunk-301-1.png" width="672" />
<ul>
<li><code>points</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_ha<span class="op">$</span>residuals<span class="op">$</span>points</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-302-1.png" width="672" /></p></li>
<li><p><code>variability_repartition</code> : pie with repartition of SumSq for each factor</p></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_ha<span class="op">$</span>variability_repartition</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-303-1.png" width="672" /></p>
<ul>
<li><code>variance_intra_germplasm</code> : repartition of the residuals for each germplasm (see Details for more information)
With the hypothesis than the micro-environmental variation is equaly distributed on all the individuals (i.e. all the plants), the distribution of each germplasm represent the intra-germplasm variance.
This has to been seen with caution:
<ul>
<li>If germplasm have no intra-germplasm variance (i.e. pure line or hybrides) then the distribution of each germplasm represent only the micro-environmental variation.</li>
<li>If germplasm have intra-germplasm variance (i.e. population such as landraces for example) then the distribution of each germplasm represent the micro-environmental variation plus the intra-germplasm variance.</li>
</ul></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_ha<span class="op">$</span>variance_intra_germplasm</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-304-1.png" width="672" /></p>
</div>
</div>
<div id="get-and-visualize-mean-comparisons-6" class="section level5">
<h5><span class="header-section-number">3.8.2.2.6</span> Get and visualize mean comparisons</h5>
<p>The method to compute mean comparison are explained in section <a href="intro-agro.html#mean-comp-check-freq">3.1.2.1.3</a>.
Here, the computation is based on emmeans.</p>
<div id="get-mean-comparisons-6" class="section level6">
<h6><span class="header-section-number">3.8.2.2.6.1</span> Get mean comparisons</h6>
<p>Get mean comparisons with <code>mean_comparisons()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">out_mean_comparisons_ha =<span class="st"> </span><span class="kw">mean_comparisons</span>(out_check_ha, <span class="dt">p.adj =</span> <span class="st">&quot;tukey&quot;</span>)</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.

## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.</code></pre>
<p><code>out_mean_comparisons_ha</code> is a list of five elements:</p>
<ul>
<li><code>info</code> : a list with variable</li>
<li><code>data_ggplot_LSDbarplot_version:germplasm</code></li>
<li><code>data_ggplot_LSDbarplot_germplasm</code></li>
<li><code>data_ggplot_LSDbarplot_location</code></li>
<li><code>data_ggplot_LSDbarplot_year</code> in case there is year in the model</li>
</ul>
</div>
<div id="visualize-mean-comparisons-5" class="section level6">
<h6><span class="header-section-number">3.8.2.2.6.2</span> Visualize mean comparisons</h6>
<pre class="sourceCode r"><code class="sourceCode r">p_out_mean_comparisons_ha =<span class="st"> </span><span class="kw">plot</span>(out_mean_comparisons_ha)</code></pre>
<p><code>p_out_mean_comparisons_ha</code> is a list of three elements with barplots :</p>
<p>For each element of the list, there are as many graph as needed with <code>nb_parameters_per_plot</code> parameters per graph.
Letters are displayed on each bar. Parameters that do not share the same letters are different regarding type I error (alpha) and alpha correction.
The error I (alpha) and the alpha correction are displayed in the title.</p>
<p>When comparing version for each germplasm, differences are displayed with stars.
The stars corresponds to the pvalue:</p>
<table>
<thead>
<tr class="header">
<th>pvalue</th>
<th>stars</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(&lt; 0.001\)</span></td>
<td>***</td>
</tr>
<tr class="even">
<td><span class="math inline">\([0.001 , 0.05]\)</span></td>
<td>**</td>
</tr>
<tr class="odd">
<td><span class="math inline">\([0.05 , 0.01]\)</span></td>
<td>*</td>
</tr>
<tr class="even">
<td><span class="math inline">\(&gt; 0.01\)</span></td>
<td>.</td>
</tr>
</tbody>
</table>
<ul>
<li><code>version:germplasm</code> : mean comparison for version for each germplasm</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">pvg =<span class="st"> </span>p_out_mean_comparisons_ha<span class="op">$</span><span class="st">&quot;version:germplasm&quot;</span>
pvg</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-307-1.png" width="672" /></p>
<ul>
<li><code>germplasm</code> : mean comparison for germplasm</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">pg =<span class="st"> </span>p_out_mean_comparisons_ha<span class="op">$</span>germplasm
pg<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span></code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-308-1.png" width="672" /></p>
<ul>
<li><code>location</code> : mean comparison for location</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">pl =<span class="st"> </span>p_out_mean_comparisons_ha<span class="op">$</span>location
pl<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span></code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-309-1.png" width="672" /></p>
<ul>
<li><code>year</code> : mean comparison for year in case there is year in the model.</li>
</ul>
</div>
</div>
<div id="post-hoc-analysis-to-visualize-variation-repartition-for-several-variables-3" class="section level5">
<h5><span class="header-section-number">3.8.2.2.7</span> post hoc analysis to visualize variation repartition for several variables</h5>
<p>First run the models</p>
<pre class="sourceCode r"><code class="sourceCode r">out_ha_<span class="dv">2</span> =<span class="st"> </span><span class="kw">model_home_away</span>(data_agro_HA, <span class="st">&quot;y2&quot;</span>)
out_ha_<span class="dv">3</span> =<span class="st"> </span><span class="kw">model_home_away</span>(data_agro_HA, <span class="st">&quot;y3&quot;</span>)</code></pre>
<p>Then check the models</p>
<pre class="sourceCode r"><code class="sourceCode r">out_check_ha_<span class="dv">2</span> =<span class="st"> </span><span class="kw">check_model</span>(out_ha_<span class="dv">2</span>)
out_check_ha_<span class="dv">3</span> =<span class="st"> </span><span class="kw">check_model</span>(out_ha_<span class="dv">3</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">list_out_check_model =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;ha_1&quot;</span> =<span class="st"> </span>out_check_ha, <span class="st">&quot;ha_2&quot;</span> =<span class="st"> </span>out_check_ha_<span class="dv">2</span>, <span class="st">&quot;ha_3&quot;</span> =<span class="st"> </span>out_check_ha_<span class="dv">3</span>)
<span class="kw">post_hoc_variation</span>(list_out_check_model)</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-312-1.png" width="672" /></p>
</div>
<div id="apply-the-workflow-to-several-variables-5" class="section level5">
<h5><span class="header-section-number">3.8.2.2.8</span> Apply the workflow to several variables</h5>
<p>If you wish to apply the AMMI workflow to several variables, you can use <code>lapply()</code> with the following code :</p>
<pre class="sourceCode r"><code class="sourceCode r">workflow_home_away =<span class="st"> </span><span class="cf">function</span>(x, data){
  out_home_away =<span class="st"> </span><span class="kw">model_home_away</span>(data, <span class="dt">variable =</span> x)
  
  out_check_home_away =<span class="st"> </span><span class="kw">check_model</span>(out_home_away)
  p_out_check_home_away =<span class="st"> </span><span class="kw">plot</span>(out_check_home_away)
  
  out_mean_comparisons_home_away =<span class="st"> </span><span class="kw">mean_comparisons</span>(out_check_home_away, <span class="dt">p.adj =</span> <span class="st">&quot;bonferroni&quot;</span>)
  p_out_mean_comparisons_home_away =<span class="st"> </span><span class="kw">plot</span>(out_mean_comparisons_home_away)
  
  out =<span class="st"> </span><span class="kw">list</span>(
    <span class="st">&quot;out_home_away&quot;</span> =<span class="st"> </span>out_home_away,
    <span class="st">&quot;out_check_home_away&quot;</span> =<span class="st"> </span>out_check_home_away,
    <span class="st">&quot;p_out_check_home_away&quot;</span> =<span class="st"> </span>p_out_check_home_away,
    <span class="st">&quot;out_mean_comparisons_home_away&quot;</span> =<span class="st"> </span>out_mean_comparisons_home_away,
    <span class="st">&quot;p_out_mean_comparisons_home_away&quot;</span> =<span class="st"> </span>p_out_mean_comparisons_home_away
  )
  
  <span class="kw">return</span>(out)
}

vec_variables =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;y1&quot;</span>, <span class="st">&quot;y2&quot;</span>, <span class="st">&quot;y3&quot;</span>)

out =<span class="st"> </span><span class="kw">lapply</span>(vec_variables, workflow_home_away, data_agro_HA)</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.

## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.

## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.

## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(out) =<span class="st"> </span>vec_variables

list_out_check_model =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;ha_1&quot;</span> =<span class="st"> </span>out<span class="op">$</span>y1<span class="op">$</span>out_check_home_away, <span class="st">&quot;ha_2&quot;</span> =<span class="st"> </span>out<span class="op">$</span>y2<span class="op">$</span>out_check_home_away, <span class="st">&quot;ha_3&quot;</span> =<span class="st"> </span>out<span class="op">$</span>y3<span class="op">$</span>out_check_home_away)

p_post_hoc_variation =<span class="st"> </span><span class="kw">post_hoc_variation</span>(list_out_check_model)</code></pre>
</div>
</div>
<div id="local-foreign" class="section level4">
<h4><span class="header-section-number">3.8.2.3</span> Local foreign</h4>
<p>Another way to study local adaptation of germplasm to their location from origin is to compare germplasm behavior on their original location with their behavior on other locations : if the first is greater than the second then the germplasm is more adapted to its original location rather than to the other locations.</p>
<p>Local in a location refers to a germplasm that has been grown or selected in a given location.
Foreign in a location refers to a germplasm that has not been grown or selected in a given location.</p>
<p>The following model take into account germplasm and location effects in order to better study version (local or foreign) effect <span class="citation">(Blanquart et al. <a href="#ref-blanquart_practical_2013">2013</a>)</span>:</p>
<p><span class="math inline">\(Y_{ijkm} = \mu + \alpha_i + \theta_j + \omega_{k_{ij}} + (\omega \times \theta)_{k_{ij}j} + rep(\theta)_{mj} + \varepsilon_{ijkm}; \quad \varepsilon_{ijkm} \sim \mathcal{N} (0,\sigma^2)\)</span></p>
<p>with</p>
<ul>
<li><span class="math inline">\(Y_{ijkm}\)</span> the phenotypic value for replication <span class="math inline">\(m\)</span>, germplasm <span class="math inline">\(i\)</span> and location <span class="math inline">\(j\)</span>, and version <span class="math inline">\(k\)</span>,</li>
<li><span class="math inline">\(\mu\)</span> the general mean,</li>
<li><span class="math inline">\(\alpha_i\)</span> the effect of germplasm <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\(\theta_j\)</span> the effect of location <span class="math inline">\(j\)</span>,</li>
<li><span class="math inline">\(\omega_{k_{ij}}\)</span> the effect of version, local or foreign for a germplasm <span class="math inline">\(i\)</span> in location <span class="math inline">\(j\)</span>,</li>
<li><span class="math inline">\((\omega \times \alpha)_{k_{ij}j}\)</span> the interaction effect of version <span class="math inline">\(\times\)</span> germplasm,</li>
<li><span class="math inline">\(rep(\theta)_{mj}\)</span> the effect of the replication <span class="math inline">\(m\)</span> nested in location,</li>
<li><span class="math inline">\(\varepsilon_{ijkm}\)</span> the residuals.</li>
</ul>
<p>As for home away model, version effect <span class="math inline">\(\omega_{k_{ij}}\)</span>) give a glocal measure of local adaptation of germplasm to their location of origin <span class="citation">(Blanquart et al. <a href="#ref-blanquart_practical_2013">2013</a>)</span>.
Interaction effect <span class="math inline">\((\omega \times \theta)_{k_{ij}j}\)</span> give information on specific adaptation to each germplasm.</p>
<p>If there are more than one year, then the model can be written :</p>
<p><span class="math inline">\(Y_{ijklm} = \mu + \alpha_i + \theta_j + \beta_l + \omega_{k_{ij}} + (\theta \times \beta)_{jl} + (\omega \times \alpha)_{k_{ij}i} + rep(\theta \times \beta)_{mjl} + (\omega \times \alpha \times \beta)_{k_{ij}il} + \varepsilon_{ijklm}; \quad \varepsilon_{ijklm} \sim \mathcal{N} (0,\sigma^2)\)</span></p>
<p>with</p>
<ul>
<li><span class="math inline">\(Y_{ijklm}\)</span> the phenotypic value for replication <span class="math inline">\(m\)</span>, germplasm <span class="math inline">\(i\)</span> and location <span class="math inline">\(j\)</span>, year <span class="math inline">\(l\)</span> and version <span class="math inline">\(k\)</span>,</li>
<li><span class="math inline">\(\mu\)</span> the general mean,</li>
<li><span class="math inline">\(\alpha_i\)</span> the effect of germplasm <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\(\theta_j\)</span> the effect of location <span class="math inline">\(j\)</span>,</li>
<li><span class="math inline">\(\beta_l\)</span> the effect of year <span class="math inline">\(l\)</span>,</li>
<li><span class="math inline">\(\omega_{k_{ij}}\)</span> the effect of version, home or away for a germplasm <span class="math inline">\(i\)</span> in location <span class="math inline">\(j\)</span>,</li>
<li>()_{jl} the interaction effect of location <span class="math inline">\(\times\)</span> year,</li>
<li>()<em>{k</em>{ij}i} the interaction effect of version <span class="math inline">\(\times\)</span> germplasm,</li>
<li>rep()_{mjl} the effect of the replication <span class="math inline">\(m\)</span> nested in location <span class="math inline">\(\times\)</span> year,</li>
<li>()<em>{k</em>{ij}il} the interaction effect of version <span class="math inline">\(\times\)</span> germplasm <span class="math inline">\(\times\)</span> year,</li>
<li>_{ijklm} the residuals.</li>
</ul>
<p>Interaction <span class="math inline">\((\omega \times \theta \times \beta)_{k_{ij}jl}\)</span> give information on specific adaptation to each germplasm for a given year.</p>
<p>A type III anova is done here as the data are not orthogonal.</p>
<div id="steps-with-ppbstats-10" class="section level5">
<h5><span class="header-section-number">3.8.2.3.1</span> Steps with <code>PPBstats</code></h5>
<p>For local foreign analysis, you can follow these steps (Figure <a href="family-4.html#fig:main-workflow-family-4-HALF">3.28</a>):</p>
<ul>
<li>Format the data with <code>format_data_PPBstats()</code></li>
<li>describe the data with <code>plot()</code></li>
<li>Run the model with <code>model_local_foreign()</code></li>
<li>Check model outputs with graphs to know if you can continue the analysis with <code>check_model()</code> and vizualise it with <code>plot()</code></li>
<li>Get mean comparisons for each factor with <code>mean_comparisons()</code> and vizualise it with <code>plot()</code></li>
</ul>
</div>
<div id="format-data-2" class="section level5">
<h5><span class="header-section-number">3.8.2.3.2</span> Format data</h5>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;data_agro_LF&quot;</span>)
data_agro_LF =<span class="st"> </span><span class="kw">format_data_PPBstats</span>(data_agro_LF, <span class="dt">type =</span> <span class="st">&quot;data_agro_LF&quot;</span>)</code></pre>
<pre><code>## Warning in format_data_PPBstats.data_agro(data): Column &quot;long&quot; is needed to
## get map and not present in data.</code></pre>
<pre><code>## Warning in format_data_PPBstats.data_agro(data): Column &quot;lat&quot; is needed to
## get map and not present in data.</code></pre>
<pre><code>## data has been formated for PPBstats functions.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(data_agro_LF)</code></pre>
<pre><code>##                 seed_lot location year germplasm block X  Y origin version
## 1 germ-1_loc-1_2005_0001    loc-1 2005    germ-1     1 A  2  loc-1   local
## 2 germ-1_loc-1_2005_0001    loc-1 2005    germ-1     2 C  6  loc-1   local
## 3 germ-1_loc-1_2005_0001    loc-1 2005    germ-1     3 B 13  loc-1   local
## 4 germ-2_loc-1_2005_0001    loc-1 2005    germ-2     1 D  5  loc-2 foreign
## 5 germ-2_loc-1_2005_0001    loc-1 2005    germ-2     2 B  9  loc-2 foreign
## 6 germ-2_loc-1_2005_0001    loc-1 2005    germ-2     3 C 14  loc-2 foreign
##         y1    y1$date       y2    y2$date       y3    y3$date
## 1 23.03428 2017-07-15 37.38970 2017-07-15 63.39528 2017-07-15
## 2 17.23622 2017-07-15 42.90576 2017-07-15 66.87962 2017-07-15
## 3 25.33605 2017-07-15 31.87826 2017-07-15 60.63063 2017-07-15
## 4 12.48506 2017-07-15 46.09260 2017-07-15 55.18082 2017-07-15
## 5 13.37886 2017-07-15 46.51270 2017-07-15 51.88016 2017-07-15
## 6 17.64994 2017-07-15 39.96316 2017-07-15 53.13201 2017-07-15
##   y1$date_julian y2$date_julian y3$date_julian
## 1            195            195            195
## 2            195            195            195
## 3            195            195            195
## 4            195            195            195
## 5            195            195            195
## 6            195            195            195</code></pre>
</div>
<div id="describe-the-data-3" class="section level5">
<h5><span class="header-section-number">3.8.2.3.3</span> Describe the data</h5>
<pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span><span class="kw">plot</span>(data_agro_LF, <span class="dt">vec_variables =</span> <span class="st">&quot;y1&quot;</span>, <span class="dt">plot_type =</span> <span class="st">&quot;barplot&quot;</span>)</code></pre>
<p><code>p</code> is a list with as many element as variable.
For each variable, there are three elements :</p>
<ul>
<li>A single plot with version for all location merged</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>y1<span class="op">$</span>local_foreign_merged</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-316-1.png" width="672" />
- A single plot with version for each location</p>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>y1<span class="op">$</span>local_foreign_merged_per_location</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-317-1.png" width="672" />
- plot for each location with all version separated</p>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>y1<span class="op">$</span>local_foreign_per_location<span class="op">$</span><span class="st">`</span><span class="dt">loc-1</span><span class="st">`</span><span class="op">$</span>version</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-318-1.png" width="672" /></p>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>y1<span class="op">$</span>local_foreign_per_location<span class="op">$</span><span class="st">`</span><span class="dt">loc-1</span><span class="st">`</span><span class="op">$</span>origin</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
<p>If you have several year in the data, you can set argument <code>f_gris = &quot;year&quot;</code> in order to have plot for each year.
In the example below t is not really relevent beaause there is only one year in the data set!</p>
<pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span><span class="kw">plot</span>(data_agro_LF, <span class="dt">vec_variables =</span> <span class="st">&quot;y1&quot;</span>, <span class="dt">plot_type =</span> <span class="st">&quot;barplot&quot;</span>, <span class="dt">f_grid =</span> <span class="st">&quot;year&quot;</span>)
p<span class="op">$</span>y1<span class="op">$</span>local_foreign_merged_per_location</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-320-1.png" width="672" /></p>
</div>
<div id="run-the-model-7" class="section level5">
<h5><span class="header-section-number">3.8.2.3.4</span> Run the model</h5>
<p>To run LOCAL FOREIGN model on the dataset, use the function <code>model_local_foreign</code>.
You can run it on one variable.</p>
<pre class="sourceCode r"><code class="sourceCode r">out_lf =<span class="st"> </span><span class="kw">model_local_foreign</span>(data_agro_LF, <span class="st">&quot;y1&quot;</span>)</code></pre>
<p><code>out_lf</code> is a list containing three elements :</p>
<ul>
<li><code>info</code> : a list with variable</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">out_lf<span class="op">$</span>info</code></pre>
<pre><code>## $variable
## [1] &quot;y1&quot;</code></pre>
<ul>
<li><code>ANOVA</code> a list with five elements :
<ul>
<li><code>model</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">out_lf<span class="op">$</span>ANOVA<span class="op">$</span>model</code></pre>
<pre><code>## 
## Call:
## stats::lm(formula = variable ~ location + germplasm + version + 
##     version:location + location/block, data = data)
## 
## Coefficients:
##                (Intercept)               locationloc-2  
##                    15.3748                      8.7827  
##              locationloc-3             germplasmgerm-2  
##                     4.2256                     -0.6989  
##            germplasmgerm-3                versionlocal  
##                     4.2563                      6.0237  
## locationloc-2:versionlocal  locationloc-3:versionlocal  
##                    -5.6698                    -15.4536  
##       locationloc-1:block2        locationloc-2:block2  
##                     0.5964                     -1.8569  
##       locationloc-3:block2        locationloc-1:block3  
##                    -0.4242                      0.8148  
##       locationloc-2:block3        locationloc-3:block3  
##                    -0.3666                     -3.3060</code></pre>
<ul>
<li><code>anova_model</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">out_lf<span class="op">$</span>ANOVA<span class="op">$</span>anova_model</code></pre>
<pre><code>## Anova Table (Type III tests)
## 
## Response: variable
##                  Sum Sq Df F value   Pr(&gt;F)   
## (Intercept)      327.30  1 17.4142 0.001093 **
## location          86.82  2  2.3096 0.138584   
## germplasm         64.74  2  1.7222 0.217027   
## version           43.54  1  2.3167 0.151940   
## location:version 122.23  2  3.2516 0.071605 . 
## location:block    26.28  6  0.2331 0.958038   
## Residuals        244.33 13                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre></li>
</ul>
</div>
<div id="check-and-visualize-model-outputs-7" class="section level5">
<h5><span class="header-section-number">3.8.2.3.5</span> Check and visualize model outputs</h5>
<p>The tests to check the model are explained in section <a href="intro-agro.html#check-model-freq">3.1.2.1.2</a>.</p>
<div id="check-the-model-7" class="section level6">
<h6><span class="header-section-number">3.8.2.3.5.1</span> Check the model</h6>
<p>Once the model is run, it is necessary to check if the outputs can be taken with confidence.
This step is needed before going ahead in the analysis (in fact, object used in the next functions must come from <code>check_model()</code>).</p>
<pre class="sourceCode r"><code class="sourceCode r">out_check_lf =<span class="st"> </span><span class="kw">check_model</span>(out_lf)</code></pre>
<p><code>out_check_lf</code> is a list containing four elements :</p>
<ul>
<li><code>model_local_foreign</code> the output from the model</li>
<li><code>data_ggplot</code> a list containing information for ggplot:
<ul>
<li><code>data_ggplot_residuals</code> a list containing :
<ul>
<li><code>data_ggplot_normality</code></li>
<li><code>data_ggplot_skewness_test</code></li>
<li><code>data_ggplot_kurtosis_test</code></li>
<li><code>data_ggplot_shapiro_test</code></li>
<li><code>data_ggplot_qqplot</code></li>
</ul></li>
<li><code>data_ggplot_variability_repartition_pie</code></li>
<li><code>data_ggplot_var_intra</code></li>
</ul></li>
</ul>
</div>
<div id="visualize-outputs-7" class="section level6">
<h6><span class="header-section-number">3.8.2.3.5.2</span> Visualize outputs</h6>
<p>Once the computation is done, you can visualize the results with <code>plot()</code></p>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_lf =<span class="st"> </span><span class="kw">plot</span>(out_check_lf)</code></pre>
<p><code>p_out_check_lf</code> is a list with:</p>
<ul>
<li><code>residuals</code>
<ul>
<li><code>histogram</code> : histogram with the distribution of the residuals</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_lf<span class="op">$</span>residuals<span class="op">$</span>histogram</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<img src="PPBstats_book_files/figure-html/unnamed-chunk-327-1.png" width="672" />
<ul>
<li><code>qqplot</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_lf<span class="op">$</span>residuals<span class="op">$</span>qqplot</code></pre>
<img src="PPBstats_book_files/figure-html/unnamed-chunk-328-1.png" width="672" />
<ul>
<li><code>points</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_lf<span class="op">$</span>residuals<span class="op">$</span>points</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-329-1.png" width="672" /></p></li>
<li><p><code>variability_repartition</code> : pie with repartition of SumSq for each factor</p></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_lf<span class="op">$</span>variability_repartition</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
<ul>
<li><code>variance_intra_germplasm</code> : repartition of the residuals for each germplasm (see Details for more information)
With the hypothesis than the micro-environmental variation is equaly distributed on all the individuals (i.e. all the plants), the distribution of each germplasm represent the intra-germplasm variance.
This has to been seen with caution:
<ul>
<li>If germplasm have no intra-germplasm variance (i.e. pure line or hybrides) then the distribution of each germplasm represent only the micro-environmental variation.</li>
<li>If germplasm have intra-germplasm variance (i.e. population such as landraces for example) then the distribution of each germplasm represent the micro-environmental variation plus the intra-germplasm variance.</li>
</ul></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_lf<span class="op">$</span>variance_intra_germplasm</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-331-1.png" width="672" /></p>
</div>
</div>
<div id="get-and-visualize-mean-comparisons-7" class="section level5">
<h5><span class="header-section-number">3.8.2.3.6</span> Get and visualize mean comparisons</h5>
<p>The method to compute mean comparison are explained in section <a href="intro-agro.html#mean-comp-check-freq">3.1.2.1.3</a>.
Here, the computation is based on emmeans.</p>
<div id="get-mean-comparisons-7" class="section level6">
<h6><span class="header-section-number">3.8.2.3.6.1</span> Get mean comparisons</h6>
<p>Get mean comparisons with <code>mean_comparisons()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">out_mean_comparisons_lf =<span class="st"> </span><span class="kw">mean_comparisons</span>(out_check_lf, <span class="dt">p.adj =</span> <span class="st">&quot;tukey&quot;</span>)</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location
## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.

## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.</code></pre>
<p><code>out_mean_comparisons_lf</code> is a list of five elements:</p>
<ul>
<li><code>info</code> : a list with variable</li>
<li><code>data_ggplot_LSDbarplot_version:germplasm</code></li>
<li><code>data_ggplot_LSDbarplot_germplasm</code></li>
<li><code>data_ggplot_LSDbarplot_location</code></li>
<li><code>data_ggplot_LSDbarplot_year</code> in case there is year in the model</li>
</ul>
</div>
<div id="visualize-mean-comparisons-6" class="section level6">
<h6><span class="header-section-number">3.8.2.3.6.2</span> Visualize mean comparisons</h6>
<pre class="sourceCode r"><code class="sourceCode r">p_out_mean_comparisons_lf =<span class="st"> </span><span class="kw">plot</span>(out_mean_comparisons_lf)</code></pre>
<p><code>p_out_mean_comparisons_lf</code> is a list of three elements with barplots :</p>
<p>For each element of the list, there are as many graph as needed with <code>nb_parameters_per_plot</code> parameters per graph.
Letters are displayed on each bar. Parameters that do not share the same letters are different regarding type I error (alpha) and alpha correction.
The error I (alpha) and the alpha correction are displayed in the title.</p>
<p>When comparing version for each germplasm, differences are displayed with stars.
The stars corresponds to the pvalue:</p>
<table>
<thead>
<tr class="header">
<th>pvalue</th>
<th>stars</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(&lt; 0.001\)</span></td>
<td>***</td>
</tr>
<tr class="even">
<td><span class="math inline">\([0.001 , 0.05]\)</span></td>
<td>**</td>
</tr>
<tr class="odd">
<td><span class="math inline">\([0.05 , 0.01]\)</span></td>
<td>*</td>
</tr>
<tr class="even">
<td><span class="math inline">\(&gt; 0.01\)</span></td>
<td>.</td>
</tr>
</tbody>
</table>
<ul>
<li><code>version:germplasm</code> : mean comparison for version for each location</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">pvg =<span class="st"> </span>p_out_mean_comparisons_lf<span class="op">$</span><span class="st">&quot;version:location&quot;</span>
pvg</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-334-1.png" width="672" /></p>
<ul>
<li><code>germplasm</code> : mean comparison for germplasm</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">pg =<span class="st"> </span>p_out_mean_comparisons_lf<span class="op">$</span>germplasm
pg<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span></code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-335-1.png" width="672" /></p>
<ul>
<li><code>location</code> : mean comparison for location</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">pl =<span class="st"> </span>p_out_mean_comparisons_lf<span class="op">$</span>location
pl<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span></code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-336-1.png" width="672" /></p>
<ul>
<li><code>year</code> : mean comparison for year in case there is year in the model.</li>
</ul>
</div>
</div>
<div id="post-hoc-analysis-to-visualize-variation-repartition-for-several-variables-4" class="section level5">
<h5><span class="header-section-number">3.8.2.3.7</span> post hoc analysis to visualize variation repartition for several variables</h5>
<p>First run the models</p>
<pre class="sourceCode r"><code class="sourceCode r">out_lf_<span class="dv">2</span> =<span class="st"> </span><span class="kw">model_local_foreign</span>(data_agro_LF, <span class="st">&quot;y2&quot;</span>)
out_lf_<span class="dv">3</span> =<span class="st"> </span><span class="kw">model_local_foreign</span>(data_agro_LF, <span class="st">&quot;y3&quot;</span>)</code></pre>
<p>Then check the models</p>
<pre class="sourceCode r"><code class="sourceCode r">out_check_lf_<span class="dv">2</span> =<span class="st"> </span><span class="kw">check_model</span>(out_lf_<span class="dv">2</span>)
out_check_lf_<span class="dv">3</span> =<span class="st"> </span><span class="kw">check_model</span>(out_lf_<span class="dv">3</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">list_out_check_model =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;lf_1&quot;</span> =<span class="st"> </span>out_check_lf, <span class="st">&quot;lf_2&quot;</span> =<span class="st"> </span>out_check_lf_<span class="dv">2</span>, <span class="st">&quot;lf_3&quot;</span> =<span class="st"> </span>out_check_lf_<span class="dv">3</span>)
<span class="kw">post_hoc_variation</span>(list_out_check_model)</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-339-1.png" width="672" /></p>
</div>
<div id="apply-the-workflow-to-several-variables-6" class="section level5">
<h5><span class="header-section-number">3.8.2.3.8</span> Apply the workflow to several variables</h5>
<p>If you wish to apply the AMMI workflow to several variables, you can use <code>lapply()</code> with the following code :</p>
<pre class="sourceCode r"><code class="sourceCode r">workflow_local_foreign =<span class="st"> </span><span class="cf">function</span>(x, data){
  out_local_foreign =<span class="st"> </span><span class="kw">model_local_foreign</span>(data, <span class="dt">variable =</span> x)
  
  out_check_local_foreign =<span class="st"> </span><span class="kw">check_model</span>(out_local_foreign)
  p_out_check_local_foreign =<span class="st"> </span><span class="kw">plot</span>(out_check_local_foreign)
  
  out_mean_comparisons_local_foreign =<span class="st"> </span><span class="kw">mean_comparisons</span>(out_check_local_foreign, <span class="dt">p.adj =</span> <span class="st">&quot;bonferroni&quot;</span>)
  p_out_mean_comparisons_local_foreign =<span class="st"> </span><span class="kw">plot</span>(out_mean_comparisons_local_foreign)
  
  out =<span class="st"> </span><span class="kw">list</span>(
    <span class="st">&quot;out_local_foreign&quot;</span> =<span class="st"> </span>out_local_foreign,
    <span class="st">&quot;out_check_local_foreign&quot;</span> =<span class="st"> </span>out_check_local_foreign,
    <span class="st">&quot;p_out_check_local_foreign&quot;</span> =<span class="st"> </span>p_out_check_local_foreign,
    <span class="st">&quot;out_mean_comparisons_local_foreign&quot;</span> =<span class="st"> </span>out_mean_comparisons_local_foreign,
    <span class="st">&quot;p_out_mean_comparisons_local_foreign&quot;</span> =<span class="st"> </span>p_out_mean_comparisons_local_foreign
  )
  
  <span class="kw">return</span>(out)
}

vec_variables =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;y1&quot;</span>, <span class="st">&quot;y2&quot;</span>, <span class="st">&quot;y3&quot;</span>)

out =<span class="st"> </span><span class="kw">lapply</span>(vec_variables, workflow_local_foreign, data_agro_LF)</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location
## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.

## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location
## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.

## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location
## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>## NOTE: A nesting structure was detected in the fitted model:
##     block %in% location</code></pre>
<pre><code>## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.

## Warning: &#39;CLD&#39; will be deprecated. Its use is discouraged.
## See &#39;? CLD&#39; for an explanation. Use &#39;pwpp&#39; or &#39;multcomp::cld&#39; instead.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(out) =<span class="st"> </span>vec_variables

list_out_check_model =<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;lf_1&quot;</span> =<span class="st"> </span>out<span class="op">$</span>y1<span class="op">$</span>out_check_local_foreign, <span class="st">&quot;lf_2&quot;</span> =<span class="st"> </span>out<span class="op">$</span>y2<span class="op">$</span>out_check_local_foreign, <span class="st">&quot;lf_3&quot;</span> =<span class="st"> </span>out<span class="op">$</span>y3<span class="op">$</span>out_check_local_foreign)

p_post_hoc_variation =<span class="st"> </span><span class="kw">post_hoc_variation</span>(list_out_check_model)</code></pre>

</div>
</div>
</div>
<div id="variance-intra" class="section level3">
<h3><span class="header-section-number">3.8.3</span> Study variance within germplasm</h3>
<div id="theory-of-the-model-6" class="section level4">
<h4><span class="header-section-number">3.8.3.1</span> Theory of the model</h4>
<p>The model is based on bayesian statistics (section <a href="intro-agro.html#section-bayes">3.1.2.2</a>).</p>
<p>The phenotypic value <span class="math inline">\(Y_{ijkl}\)</span> for a given variable <span class="math inline">\(Y\)</span>, germplasm <span class="math inline">\(i\)</span>, environment <span class="math inline">\(j\)</span>, plot <span class="math inline">\(k\)</span> and individual <span class="math inline">\(l\)</span> is modeled as :</p>
<p><span class="math inline">\(Y_{ijkl} = \mu_{ijk} + \varepsilon_{ijkl} ; \quad \varepsilon_{ijkl} \sim \mathcal{N} (0,\sigma^2_{ij})\)</span>,</p>
<p>Where <span class="math inline">\(Y_{ijkl}\)</span> is the phenotypic value for germplasm <span class="math inline">\(i\)</span>, environment <span class="math inline">\(j\)</span>, plot <span class="math inline">\(k\)</span> and individual <span class="math inline">\(l\)</span>;
<span class="math inline">\(\mu_{ijk}\)</span> is the mean of population <span class="math inline">\(i\)</span> in environnement <span class="math inline">\(j\)</span> and plot <span class="math inline">\(k\)</span> (nested in environment <span class="math inline">\(j\)</span>);
<span class="math inline">\(\varepsilon_{ijkl}\)</span> is what is not explained by the model in germplasm <span class="math inline">\(i\)</span>, environment <span class="math inline">\(j\)</span>, plot <span class="math inline">\(k\)</span> and individual <span class="math inline">\(l\)</span>.</p>
<p><span class="math inline">\(\varepsilon_{ijkl}\)</span> is taken from a normal distribution, centered on 0 with variance <span class="math inline">\(\sigma^2_{ij}\)</span></p>
<p>With priors :
<span class="math inline">\(\sigma^2_{ij} \sim 1/Gamma(10^{-6},10^{-6})\)</span> and <span class="math inline">\(\mu_{ijk} \sim N(\mu_{.j.},10^{6})\)</span></p>
<p><span class="math inline">\(\sigma^2_{ij}\)</span> correspond to the intra-germplasm variance.</p>
<p>No specific experimental design is needed as long as there are several individuals measured for a given germplasm.</p>
</div>
<div id="steps-with-ppbstats-11" class="section level4">
<h4><span class="header-section-number">3.8.3.2</span> Steps with <code>PPBstats</code></h4>
<p>For variance intra analysis, you can follow these steps (Figure (fig:main-workflow)) :</p>
<ul>
<li>Format the data with <code>format_data_PPBstats()</code></li>
<li>Run the model with <code>model_bh_intra_location()</code></li>
<li>Check model outputs with graphs to know if you can continue the analysis with <code>check_model()</code></li>
<li>Get mean comparisons for each factor with <code>mean_comparisons()</code> and vizualise it with <code>plot()</code></li>
</ul>
</div>
<div id="format-the-data-10" class="section level4">
<h4><span class="header-section-number">3.8.3.3</span> Format the data</h4>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(data_model_bh_variance_intra)
data_model_bh_variance_intra =<span class="st"> </span><span class="kw">format_data_PPBstats</span>(data_model_bh_variance_intra, <span class="dt">type =</span> <span class="st">&quot;data_agro&quot;</span>)</code></pre>
<pre><code>## Warning in format_data_PPBstats.data_agro(data): Column &quot;long&quot; is needed to
## get map and not present in data.</code></pre>
<pre><code>## Warning in format_data_PPBstats.data_agro(data): Column &quot;lat&quot; is needed to
## get map and not present in data.</code></pre>
<pre><code>## data has been formated for PPBstats functions.</code></pre>
</div>
<div id="run-the-model-8" class="section level4">
<h4><span class="header-section-number">3.8.3.4</span> Run the model</h4>
<p>To run the model , used the function <code>model_bh_intra_location</code>.
You can run it on one variable.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#out_vi = model_bh_intra_location(data_model_bh_variance_intra, variable = &quot;spike_weight&quot;, nb_iterations = 100)</span></code></pre>
</div>
<div id="check-and-visualize-model-outputs-8" class="section level4">
<h4><span class="header-section-number">3.8.3.5</span> Check and visualize model outputs</h4>
<p>The tests to check the model are explained in section <a href="intro-agro.html#check-model-bayes">3.1.2.2.2</a>.</p>
<div id="check-the-model-8" class="section level5">
<h5><span class="header-section-number">3.8.3.5.1</span> Check the model</h5>
<p>Once the model is run, it is necessary to check if the outputs can be taken with confidence.
This step is needed before going ahead in the analysis (in fact, object used in the next functions must come from <code>check_model</code>).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#out_check_vi = check_model(out_vi)</span></code></pre>
</div>
<div id="visualize-outputs-8" class="section level5">
<h5><span class="header-section-number">3.8.3.5.2</span> Visualize outputs</h5>
<p>Once the computation is done, you can visualize the results with <code>plot</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#p_out_check_vi = plot(out_check_vi)</span></code></pre>
</div>
</div>
<div id="get-and-visualize-mean-comparisons-8" class="section level4">
<h4><span class="header-section-number">3.8.3.6</span> Get and visualize mean comparisons</h4>
<p>The method to compute mean comparison are explained in section <a href="#mean-comp-check-bayes"><strong>??</strong></a>.</p>
<div id="get-mean-comparisons-8" class="section level5">
<h5><span class="header-section-number">3.8.3.6.1</span> Get mean comparisons</h5>
<p>Get mean comparisons with <code>mean_comparisons</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#out_mean_comparisons_vi = mean_comparisons(out_check_vi, parameter = &quot;mu&quot;, p.adj = &quot;soft.bonf&quot;)</span></code></pre>
</div>
<div id="visualize-outputs-9" class="section level5">
<h5><span class="header-section-number">3.8.3.6.2</span> Visualize outputs</h5>
<p>Once the computation is done, you can visualize the results with <code>plot</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#p_out_mc_vi = plot(out_mean_comparisons_vi)</span></code></pre>
</div>
</div>
<div id="apply-the-workflow-to-several-variables-7" class="section level4">
<h4><span class="header-section-number">3.8.3.7</span> Apply the workflow to several variables</h4>
<p>If you wish to apply the variance_intra workflow to several variables, you can use <code>lapply</code> with the following code :</p>
<pre class="sourceCode r"><code class="sourceCode r">workflow_model_variance_intra =<span class="st"> </span><span class="cf">function</span>(x){
  out_vi =<span class="st"> </span><span class="kw">model_bh_intra_location</span>(data_variance_intra, <span class="dt">variable =</span> x)
  
  out_check_vi =<span class="st"> </span><span class="kw">check_model</span>(out_vi)
  p_out_check_vi =<span class="st"> </span><span class="kw">plot</span>(out_check_vi)
  
  out_mean_comparisons_vi =<span class="st"> </span><span class="kw">mean_comparisons</span>(out_check_vi, <span class="dt">p.adj =</span> <span class="st">&quot;bonferroni&quot;</span>)
  p_out_mean_comparisons_vi =<span class="st"> </span><span class="kw">plot</span>(out_mean_comparisons_vi)
  
  out =<span class="st"> </span><span class="kw">list</span>(
    <span class="st">&quot;out_vi&quot;</span> =<span class="st"> </span>out_vi,
    <span class="st">&quot;out_check_vi&quot;</span> =<span class="st"> </span>out_check_vi,
    <span class="st">&quot;p_out_check_vi&quot;</span> =<span class="st"> </span>p_out_check_vi,
    <span class="st">&quot;out_mean_comparisons_vi&quot;</span> =<span class="st"> </span>out_mean_comparisons_vi,
    <span class="st">&quot;p_out_mean_comparisons_vi&quot;</span> =<span class="st"> </span>p_out_mean_comparisons_vi
  )
  
  <span class="kw">return</span>(out)
}

<span class="co">## Not run because of memory and time issues !</span>
<span class="co"># vec_variables = c(&quot;y1&quot;, &quot;y2&quot;, &quot;y3&quot;)</span>
<span class="co">#</span>
<span class="co"># out = lapply(vec_variables, workflow_model_variance_intra)</span>
<span class="co"># names(out) = vec_variables</span></code></pre>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-blanquart_practical_2013">
<p>Blanquart, F., O. Kaltz, S.L. Nuismer, and S. Gandon. 2013. “A Practical Guide to Measuring Local Adaptation.” <em>Ecology Letters</em> 16 (9): 1195–1205. <a href="https://doi.org/10.1111/ele.12150">https://doi.org/10.1111/ele.12150</a>.</p>
</div>
<div id="ref-SandR_EN">
<p>Rivière, P. 2015. “Reponse to Selection Experiment.” <a href="https://github.com/priviere/module_figures_images_photos/releases/download/v4/SandR_EN.zip">https://github.com/priviere/module_figures_images_photos/releases/download/v4/SandR_EN.zip</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="family-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="family-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/priviere/PPBstats/edit/master/317-agro_family_4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["PPBstats_book.pdf", "PPBstats_book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
