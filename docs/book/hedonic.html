<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.3 Hedonic analysis (M9b) | PPBstats : An R package for Participatory Plant Breeding statisticial analyses</title>
  <meta name="description" content="Tutorial on how to use the R package PPBstats." />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="4.3 Hedonic analysis (M9b) | PPBstats : An R package for Participatory Plant Breeding statisticial analyses" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Tutorial on how to use the R package PPBstats." />
  <meta name="github-repo" content="priviere/PPBstats" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.3 Hedonic analysis (M9b) | PPBstats : An R package for Participatory Plant Breeding statisticial analyses" />
  
  <meta name="twitter:description" content="Tutorial on how to use the R package PPBstats." />
  

<meta name="author" content="Pierre Rivière" />


<meta name="date" content="2021-07-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="taste.html">
<link rel="next" href="napping.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="../index.html" >PPBstats website</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li><a href="authors-and-contributors-of-ppbstats-and-the-book.html#authors-and-contributors-of-ppbstats-and-the-book">Authors and contributors of <code>PPBstats</code> and the book</a></li>
<li class="chapter" data-level="" data-path="copyright-licence-citation.html"><a href="copyright-licence-citation.html"><i class="fa fa-check"></i>Copyright, Licence, citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="philo.html"><a href="philo.html"><i class="fa fa-check"></i><b>1</b> Philosophy of PPBstats</a><ul>
<li class="chapter" data-level="1.1" data-path="what-is-participatory-plant-bredding.html"><a href="what-is-participatory-plant-bredding.html"><i class="fa fa-check"></i><b>1.1</b> What is Participatory Plant Bredding ?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="what-is-participatory-plant-bredding.html"><a href="what-is-participatory-plant-bredding.html#decentralize-the-selection"><i class="fa fa-check"></i><b>1.1.1</b> Decentralize the selection</a></li>
<li class="chapter" data-level="1.1.2" data-path="what-is-participatory-plant-bredding.html"><a href="what-is-participatory-plant-bredding.html#involve-all-actors-in-the-breeding-decision-process"><i class="fa fa-check"></i><b>1.1.2</b> Involve all actors in the breeding decision process</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="objectives-of-ppbstats.html"><a href="objectives-of-ppbstats.html"><i class="fa fa-check"></i><b>1.2</b> Objectives of <code>PPBstats</code></a></li>
<li class="chapter" data-level="1.3" data-path="contribute.html"><a href="contribute.html"><i class="fa fa-check"></i><b>1.3</b> Contribute</a></li>
<li class="chapter" data-level="1.4" data-path="design-and-statistical-methods-according-to-the-objectives.html"><a href="design-and-statistical-methods-according-to-the-objectives.html"><i class="fa fa-check"></i><b>1.4</b> Design and statistical methods according to the objectives</a></li>
<li class="chapter" data-level="1.5" data-path="lets-go-install-ppbstats-and-the-data-used-in-the-book.html"><a href="lets-go-install-ppbstats-and-the-data-used-in-the-book.html"><i class="fa fa-check"></i><b>1.5</b> Let’s go: install <code>PPBstats</code> and the data used in the book!</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="network.html"><a href="network.html"><i class="fa fa-check"></i><b>2</b> Analysis of network seed circulation (<strong>M8</strong>)</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction.html"><a href="introduction.html#workflow-and-function-relations-in-ppbstats-regarding-network-analysis"><i class="fa fa-check"></i><b>2.1.1</b> Workflow and function relations in <code>PPBstats</code> regarding network analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="unipart-network-for-seed-lots-analysis.html"><a href="unipart-network-for-seed-lots-analysis.html"><i class="fa fa-check"></i><b>2.2</b> Unipart network for seed lots analysis</a><ul>
<li class="chapter" data-level="2.2.1" data-path="unipart-network-for-seed-lots-analysis.html"><a href="unipart-network-for-seed-lots-analysis.html#steps-with-ppbstats"><i class="fa fa-check"></i><b>2.2.1</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="2.2.2" data-path="unipart-network-for-seed-lots-analysis.html"><a href="unipart-network-for-seed-lots-analysis.html#format-the-data"><i class="fa fa-check"></i><b>2.2.2</b> Format the data</a></li>
<li class="chapter" data-level="2.2.3" data-path="unipart-network-for-seed-lots-analysis.html"><a href="unipart-network-for-seed-lots-analysis.html#describe-the-data"><i class="fa fa-check"></i><b>2.2.3</b> Describe the data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="unipart-network-for-location-analysis.html"><a href="unipart-network-for-location-analysis.html"><i class="fa fa-check"></i><b>2.3</b> Unipart network for location analysis</a><ul>
<li class="chapter" data-level="2.3.1" data-path="unipart-network-for-location-analysis.html"><a href="unipart-network-for-location-analysis.html#steps-with-ppbstats-1"><i class="fa fa-check"></i><b>2.3.1</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="unipart-network-for-location-analysis.html"><a href="unipart-network-for-location-analysis.html#format-the-data-1"><i class="fa fa-check"></i><b>2.3.2</b> Format the data</a></li>
<li class="chapter" data-level="2.3.3" data-path="unipart-network-for-location-analysis.html"><a href="unipart-network-for-location-analysis.html#format-and-describe-the-data-for-each-germplasm"><i class="fa fa-check"></i><b>2.3.3</b> Format and describe the data for each germplasm</a></li>
<li class="chapter" data-level="2.3.4" data-path="unipart-network-for-location-analysis.html"><a href="unipart-network-for-location-analysis.html#format-and-describe-the-data-for-each-year"><i class="fa fa-check"></i><b>2.3.4</b> Format and describe the data for each year</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bipart-network-analysis.html"><a href="bipart-network-analysis.html"><i class="fa fa-check"></i><b>2.4</b> Bipart network analysis</a><ul>
<li class="chapter" data-level="2.4.1" data-path="bipart-network-analysis.html"><a href="bipart-network-analysis.html#steps-with-ppbstats-2"><i class="fa fa-check"></i><b>2.4.1</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="2.4.2" data-path="bipart-network-analysis.html"><a href="bipart-network-analysis.html#format-the-data-2"><i class="fa fa-check"></i><b>2.4.2</b> Format the data</a></li>
<li class="chapter" data-level="2.4.3" data-path="bipart-network-analysis.html"><a href="bipart-network-analysis.html#describe-the-data-1"><i class="fa fa-check"></i><b>2.4.3</b> Describe the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="agronomic.html"><a href="agronomic.html"><i class="fa fa-check"></i><b>3</b> Analysis of agronomic traits</a><ul>
<li class="chapter" data-level="3.1" data-path="intro-agro.html"><a href="intro-agro.html"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="intro-agro.html"><a href="intro-agro.html#objective-agro"><i class="fa fa-check"></i><b>3.1.1</b> Analysis according to the objectives</a></li>
<li class="chapter" data-level="3.1.2" data-path="intro-agro.html"><a href="intro-agro.html#family-analysis-agro"><i class="fa fa-check"></i><b>3.1.2</b> Family of analyses</a></li>
<li class="chapter" data-level="3.1.3" data-path="intro-agro.html"><a href="intro-agro.html#expe-design"><i class="fa fa-check"></i><b>3.1.3</b> Experimental design</a></li>
<li class="chapter" data-level="3.1.4" data-path="intro-agro.html"><a href="intro-agro.html#decision-tree"><i class="fa fa-check"></i><b>3.1.4</b> Decision tree</a></li>
<li class="chapter" data-level="3.1.5" data-path="intro-agro.html"><a href="intro-agro.html#workflow-agro"><i class="fa fa-check"></i><b>3.1.5</b> Workflow and function relations in <code>PPBstats</code> regarding agronomic analysis</a></li>
<li class="chapter" data-level="3.1.6" data-path="intro-agro.html"><a href="intro-agro.html#data-agro"><i class="fa fa-check"></i><b>3.1.6</b> Data format</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="doe.html"><a href="doe.html"><i class="fa fa-check"></i><b>3.2</b> Design the experiment</a><ul>
<li class="chapter" data-level="3.2.1" data-path="doe.html"><a href="doe.html#fully-replicated"><i class="fa fa-check"></i><b>3.2.1</b> Fully-replicated (<strong>D1</strong>)</a></li>
<li class="chapter" data-level="3.2.2" data-path="doe.html"><a href="doe.html#ibd"><i class="fa fa-check"></i><b>3.2.2</b> Incomplete Block Design (<strong>D2</strong>)</a></li>
<li class="chapter" data-level="3.2.3" data-path="doe.html"><a href="doe.html#row-column"><i class="fa fa-check"></i><b>3.2.3</b> Row-column (<strong>D3</strong>)</a></li>
<li class="chapter" data-level="3.2.4" data-path="doe.html"><a href="doe.html#rf-sf"><i class="fa fa-check"></i><b>3.2.4</b> Regional and satellite farms (<strong>D4</strong>)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sow.html"><a href="sow.html"><i class="fa fa-check"></i><b>3.3</b> Sow, note, harvest, measure …</a></li>
<li class="chapter" data-level="3.4" data-path="describe-data-agro.html"><a href="describe-data-agro.html"><i class="fa fa-check"></i><b>3.4</b> Describe the data</a><ul>
<li class="chapter" data-level="3.4.1" data-path="describe-data-agro.html"><a href="describe-data-agro.html#format-the-data-3"><i class="fa fa-check"></i><b>3.4.1</b> Format the data</a></li>
<li class="chapter" data-level="3.4.2" data-path="describe-data-agro.html"><a href="describe-data-agro.html#presence-abscence-matrix"><i class="fa fa-check"></i><b>3.4.2</b> presence abscence matrix</a></li>
<li class="chapter" data-level="3.4.3" data-path="describe-data-agro.html"><a href="describe-data-agro.html#histogramm"><i class="fa fa-check"></i><b>3.4.3</b> histogramm</a></li>
<li class="chapter" data-level="3.4.4" data-path="describe-data-agro.html"><a href="describe-data-agro.html#barplot"><i class="fa fa-check"></i><b>3.4.4</b> barplot</a></li>
<li class="chapter" data-level="3.4.5" data-path="describe-data-agro.html"><a href="describe-data-agro.html#boxplot"><i class="fa fa-check"></i><b>3.4.5</b> boxplot</a></li>
<li class="chapter" data-level="3.4.6" data-path="describe-data-agro.html"><a href="describe-data-agro.html#interaction"><i class="fa fa-check"></i><b>3.4.6</b> interaction</a></li>
<li class="chapter" data-level="3.4.7" data-path="describe-data-agro.html"><a href="describe-data-agro.html#biplot"><i class="fa fa-check"></i><b>3.4.7</b> biplot</a></li>
<li class="chapter" data-level="3.4.8" data-path="describe-data-agro.html"><a href="describe-data-agro.html#radar"><i class="fa fa-check"></i><b>3.4.8</b> radar</a></li>
<li class="chapter" data-level="3.4.9" data-path="describe-data-agro.html"><a href="describe-data-agro.html#raster"><i class="fa fa-check"></i><b>3.4.9</b> raster</a></li>
<li class="chapter" data-level="3.4.10" data-path="describe-data-agro.html"><a href="describe-data-agro.html#map"><i class="fa fa-check"></i><b>3.4.10</b> map</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="family-1.html"><a href="family-1.html"><i class="fa fa-check"></i><b>3.5</b> Family 1 of analysis : Compare different varieties evaluated for selection in different locations.</a><ul>
<li class="chapter" data-level="3.5.1" data-path="family-1.html"><a href="family-1.html#decision-tree-1"><i class="fa fa-check"></i><b>3.5.1</b> Decision tree</a></li>
<li class="chapter" data-level="3.5.2" data-path="family-1.html"><a href="family-1.html#workflow-and-function-relations-in-ppbstats-regarding-family-1-of-analysis"><i class="fa fa-check"></i><b>3.5.2</b> Workflow and function relations in <code>PPBstats</code> regarding family 1 of analysis</a></li>
<li class="chapter" data-level="3.5.3" data-path="family-1.html"><a href="family-1.html#classic-anova"><i class="fa fa-check"></i><b>3.5.3</b> Classic ANOVA (<strong>M4a</strong>)</a></li>
<li class="chapter" data-level="3.5.4" data-path="family-1.html"><a href="family-1.html#spatial-analysis"><i class="fa fa-check"></i><b>3.5.4</b> Spatial analysis (<strong>M4b</strong>)</a></li>
<li class="chapter" data-level="3.5.5" data-path="family-1.html"><a href="family-1.html#ibd-model"><i class="fa fa-check"></i><b>3.5.5</b> Mixted model for incomplete block design (<strong>M5</strong>)</a></li>
<li class="chapter" data-level="3.5.6" data-path="family-1.html"><a href="family-1.html#model-1"><i class="fa fa-check"></i><b>3.5.6</b> Hierarchical Bayesian intra-location model to perform mean comparisons with each farm (<strong>M7a</strong>)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="family-2.html"><a href="family-2.html"><i class="fa fa-check"></i><b>3.6</b> Family 2 of analysis : Study the response of varieties under selection over several environments</a><ul>
<li class="chapter" data-level="3.6.1" data-path="family-2.html"><a href="family-2.html#decision-tree-2"><i class="fa fa-check"></i><b>3.6.1</b> Decision tree</a></li>
<li class="chapter" data-level="3.6.2" data-path="family-2.html"><a href="family-2.html#workflow-and-function-relations-in-ppbstats-regarding-family-2-of-analysis"><i class="fa fa-check"></i><b>3.6.2</b> Workflow and function relations in <code>PPBstats</code> regarding family 2 of analysis</a></li>
<li class="chapter" data-level="3.6.3" data-path="family-2.html"><a href="family-2.html#ammi"><i class="fa fa-check"></i><b>3.6.3</b> AMMI (<strong>M6a</strong>)</a></li>
<li class="chapter" data-level="3.6.4" data-path="family-2.html"><a href="family-2.html#gge"><i class="fa fa-check"></i><b>3.6.4</b> GGE (<strong>M6b</strong>)</a></li>
<li class="chapter" data-level="3.6.5" data-path="family-2.html"><a href="family-2.html#model-2"><i class="fa fa-check"></i><b>3.6.5</b> Hierarchical Bayesian <span class="math inline">\(G \times E\)</span> model to analyse <span class="math inline">\(G \times E\)</span> interaction in the network of farms (<strong>M7b</strong>)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="family-3.html"><a href="family-3.html"><i class="fa fa-check"></i><b>3.7</b> Family 3 of analysis : effects from family 1 and 2 in a network of farms</a><ul>
<li class="chapter" data-level="3.7.1" data-path="family-3.html"><a href="family-3.html#model-3"><i class="fa fa-check"></i><b>3.7.1</b> model 3</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="family-4.html"><a href="family-4.html"><i class="fa fa-check"></i><b>3.8</b> Family 4 of analysis : specific research questions on one farm or more</a><ul>
<li class="chapter" data-level="3.8.1" data-path="family-4.html"><a href="family-4.html#response-to-selection"><i class="fa fa-check"></i><b>3.8.1</b> Study reponse to selection</a></li>
<li class="chapter" data-level="3.8.2" data-path="family-4.html"><a href="family-4.html#study-local-adaptation"><i class="fa fa-check"></i><b>3.8.2</b> Study local adaptation</a></li>
<li class="chapter" data-level="3.8.3" data-path="family-4.html"><a href="family-4.html#variance-intra"><i class="fa fa-check"></i><b>3.8.3</b> Study variance within germplasm</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="family-5.html"><a href="family-5.html"><i class="fa fa-check"></i><b>3.9</b> Family 5 of analysis : multivariate analysis</a><ul>
<li class="chapter" data-level="3.9.1" data-path="family-5.html"><a href="family-5.html#decision-tree-3"><i class="fa fa-check"></i><b>3.9.1</b> Decision tree</a></li>
<li class="chapter" data-level="3.9.2" data-path="family-5.html"><a href="family-5.html#workflow-and-function-relations-in-ppbstats-regarding-family-2-of-analysis-1"><i class="fa fa-check"></i><b>3.9.2</b> Workflow and function relations in <code>PPBstats</code> regarding family 2 of analysis</a></li>
<li class="chapter" data-level="3.9.3" data-path="family-5.html"><a href="family-5.html#steps-with-ppbstats-12"><i class="fa fa-check"></i><b>3.9.3</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="3.9.4" data-path="family-5.html"><a href="family-5.html#format-the-data-11"><i class="fa fa-check"></i><b>3.9.4</b> Format the data</a></li>
<li class="chapter" data-level="3.9.5" data-path="family-5.html"><a href="family-5.html#look-at-correlation"><i class="fa fa-check"></i><b>3.9.5</b> Look at correlation</a></li>
<li class="chapter" data-level="3.9.6" data-path="family-5.html"><a href="family-5.html#run-the-analysis"><i class="fa fa-check"></i><b>3.9.6</b> Run the analysis</a></li>
<li class="chapter" data-level="3.9.7" data-path="family-5.html"><a href="family-5.html#check-outputs-and-results"><i class="fa fa-check"></i><b>3.9.7</b> Check outputs and results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="organoleptic.html"><a href="organoleptic.html"><i class="fa fa-check"></i><b>4</b> Sensory analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="intro-organo.html"><a href="intro-organo.html"><i class="fa fa-check"></i><b>4.1</b> Introduction</a><ul>
<li class="chapter" data-level="4.1.1" data-path="intro-organo.html"><a href="intro-organo.html#objective-organo"><i class="fa fa-check"></i><b>4.1.1</b> Analysis according to the objectives</a></li>
<li class="chapter" data-level="4.1.2" data-path="intro-organo.html"><a href="intro-organo.html#decision-tree-organo"><i class="fa fa-check"></i><b>4.1.2</b> Decision tree</a></li>
<li class="chapter" data-level="4.1.3" data-path="intro-organo.html"><a href="intro-organo.html#workflow-organo"><i class="fa fa-check"></i><b>4.1.3</b> Workflow and function relations in <code>PPBstats</code> regarding organoleptic analysis</a></li>
<li class="chapter" data-level="4.1.4" data-path="intro-organo.html"><a href="intro-organo.html#data-organo"><i class="fa fa-check"></i><b>4.1.4</b> Data format</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="taste.html"><a href="taste.html"><i class="fa fa-check"></i><b>4.2</b> Taste and measure …</a></li>
<li class="chapter" data-level="4.3" data-path="hedonic.html"><a href="hedonic.html"><i class="fa fa-check"></i><b>4.3</b> Hedonic analysis (<strong>M9b</strong>)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="hedonic.html"><a href="hedonic.html#method-description"><i class="fa fa-check"></i><b>4.3.1</b> Method description</a></li>
<li class="chapter" data-level="4.3.2" data-path="hedonic.html"><a href="hedonic.html#steps-with-ppbstats-13"><i class="fa fa-check"></i><b>4.3.2</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="hedonic.html"><a href="hedonic.html#format-the-data-12"><i class="fa fa-check"></i><b>4.3.3</b> Format the data</a></li>
<li class="chapter" data-level="4.3.4" data-path="hedonic.html"><a href="hedonic.html#describe-the-data-4"><i class="fa fa-check"></i><b>4.3.4</b> Describe the data</a></li>
<li class="chapter" data-level="4.3.5" data-path="hedonic.html"><a href="hedonic.html#run-the-model-9"><i class="fa fa-check"></i><b>4.3.5</b> Run the model</a></li>
<li class="chapter" data-level="4.3.6" data-path="hedonic.html"><a href="hedonic.html#check-and-visualize-model-outputs-9"><i class="fa fa-check"></i><b>4.3.6</b> Check and visualize model outputs</a></li>
<li class="chapter" data-level="4.3.7" data-path="hedonic.html"><a href="hedonic.html#get-and-visualize-mean-comparisons-on-note"><i class="fa fa-check"></i><b>4.3.7</b> Get and visualize mean comparisons on note</a></li>
<li class="chapter" data-level="4.3.8" data-path="hedonic.html"><a href="hedonic.html#get-and-visualize-biplot-regarding-samples-ca-and-juges-hcpc"><i class="fa fa-check"></i><b>4.3.8</b> Get and visualize biplot regarding samples (CA) and juges (HCPC)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="napping.html"><a href="napping.html"><i class="fa fa-check"></i><b>4.4</b> Napping analysis (<strong>M9a</strong>)</a><ul>
<li class="chapter" data-level="4.4.1" data-path="napping.html"><a href="napping.html#method-description-1"><i class="fa fa-check"></i><b>4.4.1</b> Method description</a></li>
<li class="chapter" data-level="4.4.2" data-path="napping.html"><a href="napping.html#steps-with-ppbstats-14"><i class="fa fa-check"></i><b>4.4.2</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="4.4.3" data-path="napping.html"><a href="napping.html#format-the-data-13"><i class="fa fa-check"></i><b>4.4.3</b> Format the data</a></li>
<li class="chapter" data-level="4.4.4" data-path="napping.html"><a href="napping.html#describe-the-data-5"><i class="fa fa-check"></i><b>4.4.4</b> Describe the data</a></li>
<li class="chapter" data-level="4.4.5" data-path="napping.html"><a href="napping.html#run-the-model-10"><i class="fa fa-check"></i><b>4.4.5</b> Run the model</a></li>
<li class="chapter" data-level="4.4.6" data-path="napping.html"><a href="napping.html#check-and-visualize-model-outputs-10"><i class="fa fa-check"></i><b>4.4.6</b> Check and visualize model outputs</a></li>
<li class="chapter" data-level="4.4.7" data-path="napping.html"><a href="napping.html#get-and-visualize-biplot-2"><i class="fa fa-check"></i><b>4.4.7</b> Get and visualize biplot</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="rank.html"><a href="rank.html"><i class="fa fa-check"></i><b>4.5</b> Rank analysis (<strong>M9c</strong>)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="rank.html"><a href="rank.html#method-description-2"><i class="fa fa-check"></i><b>4.5.1</b> Method description</a></li>
<li class="chapter" data-level="4.5.2" data-path="rank.html"><a href="rank.html#steps-with-ppbstats-15"><i class="fa fa-check"></i><b>4.5.2</b> Steps with <code>PPBstats</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="rank.html"><a href="rank.html#format-the-data-14"><i class="fa fa-check"></i><b>4.5.3</b> Format the data</a></li>
<li class="chapter" data-level="4.5.4" data-path="rank.html"><a href="rank.html#run-the-model-11"><i class="fa fa-check"></i><b>4.5.4</b> Run the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="molecular.html"><a href="molecular.html"><i class="fa fa-check"></i><b>5</b> Molecular analysis (<strong>M3</strong>)</a></li>
<li class="chapter" data-level="6" data-path="com.html"><a href="com.html"><i class="fa fa-check"></i><b>6</b> Communicate results to farmers</a><ul>
<li class="chapter" data-level="6.1" data-path="com-technic.html"><a href="com-technic.html"><i class="fa fa-check"></i><b>6.1</b> Technical aspects</a><ul>
<li class="chapter" data-level="6.1.1" data-path="com-technic.html"><a href="com-technic.html#run-the-analysis-1"><i class="fa fa-check"></i><b>6.1.1</b> Run the analysis</a></li>
<li class="chapter" data-level="6.1.2" data-path="com-technic.html"><a href="com-technic.html#create-a-.rmd-template"><i class="fa fa-check"></i><b>6.1.2</b> Create a <code>.Rmd</code> template</a></li>
<li class="chapter" data-level="6.1.3" data-path="com-technic.html"><a href="com-technic.html#generate-a-report-for-each-location"><i class="fa fa-check"></i><b>6.1.3</b> Generate a report for each location</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="com-rules.html"><a href="com-rules.html"><i class="fa fa-check"></i><b>6.2</b> Organisational aspects on collective work</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="acknowledgement.html"><a href="acknowledgement.html"><i class="fa fa-check"></i>Acknowledgement</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="../index.html" target="_blank">PPBstats website</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><code>PPBstats</code> : An <code>R</code> package for Participatory Plant Breeding statisticial analyses</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hedonic" class="section level2">
<h2><span class="header-section-number">4.3</span> Hedonic analysis (<strong>M9b</strong>)</h2>
<div id="method-description" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Method description</h3>
<p>The hedonic evaluation test involves asking consumers to :</p>
<ol style="list-style-type: decimal">
<li>to rate their preference from 1 (I dislike extremely) to 9 (I like very much) for three to four sensory attributes specific to the test product.
The overall preference is ascertained at the beginning of the questionnaire in order not to influence the consumer and be closer to typical conditions of consumption.</li>
<li>give additional information such as sex, age and organic consumption frequency in order to characterise the population sample.</li>
<li>give additional sensory descriptors to describe products are asked after evaluation of each product.</li>
</ol>
<div id="determine-differences-of-appreciation-for-each-samples" class="section level4">
<h4><span class="header-section-number">4.3.1.1</span> Determine differences of appreciation for each samples</h4>
<p>Regarding samples, the objectives of the hedonic tests are to</p>
<ol style="list-style-type: decimal">
<li>determine differences of appreciation for a given attribute between the set of samples bsed on the note given by the juges and</li>
<li>determine appreciation of samples based on descriptors given by the juges</li>
</ol>
<p><strong>Differences of sample regarding the note given by the juges.</strong></p>
<p>The data distribution determines the type of tests that should be used to analyze the data set.</p>
<ul>
<li>If the distribution is Normal, one-way analysis of variance (ANOVA) can be performed:</li>
</ul>
<p><span class="math inline">\(Y_{ij} = \alpha_i + \beta_j + \varepsilon_{ij}; \quad \varepsilon_{ijkl} \sim \mathcal{N} (0,\sigma^2)\)</span></p>
<p>with
<span class="math inline">\(Y_{ij}\)</span> the note from 1 to 9 given by a person to a sample,
<span class="math inline">\(\alpha_i\)</span> the person (i.e. assessor) that taste the sample,
<span class="math inline">\(\beta_j\)</span> the germplasm tasted,
<span class="math inline">\(\varepsilon_{ijkl}\)</span> the residuals.</p>
<p>Then, multiple comparison of mean on germplasm are performed.
The aim is to obtain a final ranking based on consumers’ preferences.</p>
<ul>
<li>If the data set doesn’t follow a Normal distribution, a Friedman test on the rank should be used to indicate if the varieties are perceived differently by assessors.</li>
</ul>
<p><strong>Appreciation of sample regarding the descriptors given by the juges.</strong></p>
<p>To do so, Correspondance Analysis (CA) is done on the data with descriptors.</p>
</div>
<div id="juges-profiles" class="section level4">
<h4><span class="header-section-number">4.3.1.2</span> Juges profiles</h4>
<p>Another objective of the analysis is to determine juges profiles based on the note given and the additional information such as sex, age and organic consumption frequency, etc.</p>
<p>It is done with a Hierarchical Clustering on Principle Components (HCPC) that can be implement to identify groups of juges preferences after a Principal Component Analysis (PCA).</p>
</div>
</div>
<div id="steps-with-ppbstats-13" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Steps with <code>PPBstats</code></h3>
<p>For hedonic analysis, you can follow these steps (Figure <a href="intro-organo.html#fig:main-workflow-organo">4.2</a>):</p>
<ul>
<li>Format the data with <code>format_data_PPBstats()</code></li>
<li>Describe the data with <code>plot()</code></li>
<li>Run the model with <code>model_hedonic()</code></li>
<li>Check model outputs with graphs to know if you can continue the analysis with <code>check_model()</code></li>
<li>Get mean comparisons on the note given by the juges for each factor with <code>mean_comparisons()</code> and vizualise it with <code>plot()</code></li>
<li>Format data for CA and HCPC analysis with <code>biplot_data()</code> and visualise it with <code>plot()</code></li>
</ul>
</div>
<div id="format-the-data-12" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Format the data</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(data_hedonic)
<span class="kw">head</span>(data_hedonic)</code></pre>
<pre><code>##   sample germplasm location juges note           descriptors Age Sexe
## 1    832    germ-1    loc-1     1    7        douce; juteuse  21    F
## 2    412    germ-1    loc-1     1    8       juteuse; sucree  21    F
## 3    465    germ-2    loc-1     1    5                 acide  21    F
## 4    108    germ-3    loc-1     1    7                sucree  21    F
## 5    967    germ-4    loc-1     1    8                sucree  21    F
## 6    619    germ-5    loc-1     1    6 peau epaisse; juteuse  21    F
##   Bio.Non.Bio Circuit Departement
## 1           1   1;2;3          30
## 2           1   1;2;3          30
## 3           1   1;2;3          30
## 4           1   1;2;3          30
## 5           1   1;2;3          30
## 6           1   1;2;3          30</code></pre>
<p>The data frame has the following columns: sample, germplasm, location, juges, note, descriptors.
The descriptors must be separated by “;”.
Any other column can be added as supplementary variables.</p>
<p>Then, you must format your data with <code>format_data_PPBstats()</code> and <code>type = &quot;data_organo_hedonic&quot;</code>.
Argument <code>threshold</code> can be set in order to keep only descriptors that have been cited several time.
For exemple with <code>threshold = 2</code>, only descriptors cited at least twice are kept.</p>
<pre class="sourceCode r"><code class="sourceCode r">data_hedonic =<span class="st"> </span><span class="kw">format_data_PPBstats</span>(data_hedonic, <span class="dt">type =</span> <span class="st">&quot;data_organo_hedonic&quot;</span>, <span class="dt">threshold =</span> <span class="dv">2</span>)</code></pre>
<pre><code>## Warning in format_data_PPBstats.data_organo_hedonic(data, threshold): The following samples are not kept because they have been already tasted (i.e. germplasm and location combinaison already exist):
## sample 412 by juge 1 on row 2</code></pre>
<pre><code>## Warning in format_data_PPBstats.data_organo_hedonic(data, threshold): The
## following row in data have been remove because there are no descriptors :9</code></pre>
<pre><code>## The following descriptors have been remove because there were less or equal to 2 occurences : aciduee,  acidulee, classique,  classique, classique , cremeuse, croquante, epicee,  equilibree,  farineuse,  ferme,  fondante, legere, molle,  parfumee, salee, sucree</code></pre>
<pre><code>## data has been formated for PPBstats functions.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(data_hedonic)</code></pre>
<pre><code>## [1] &quot;data&quot;        &quot;var_sup&quot;     &quot;descriptors&quot;</code></pre>
<p><code>data_hedonic</code> is a list of four elements :</p>
<ul>
<li><code>data</code> the data formated to run the anova and the multivariate analysis regarding
<ul>
<li>sample</li>
</ul></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(data_hedonic<span class="op">$</span>data<span class="op">$</span>data_sample)</code></pre>
<pre><code>##         sample germplasm location juges note Age Sexe Bio.Non.Bio Circuit
## 1 loc-1:germ-1    germ-1    loc-1     1    7  21    F           1   1;2;3
## 2 loc-1:germ-2    germ-2    loc-1     1    5  21    F           1   1;2;3
## 3 loc-1:germ-3    germ-3    loc-1     1    7  21    F           1   1;2;3
## 4 loc-1:germ-4    germ-4    loc-1     1    8  21    F           1   1;2;3
## 5 loc-1:germ-5    germ-5    loc-1     1    6  21    F           1   1;2;3
## 6 loc-1:germ-6    germ-6    loc-1     2    7  30    F           1        
##   Departement      acide acidulee charnue      douce  douce equilibree
## 1          30 0.00000000        0       0 0.03703704      0          0
## 2          30 0.02941176        0       0 0.00000000      0          0
## 3          30 0.00000000        0       0 0.00000000      0          0
## 4          30 0.00000000        0       0 0.00000000      0          0
## 5          30 0.00000000        0       0 0.00000000      0          0
## 6          11 0.00000000        0       0 0.00000000      0          0
##   farineuse ferme fraiche fruitee goutue  goutue juteuse   juteuse neutre
## 1         0     0       0       0      0       0       0 0.3333333      0
## 2         0     0       0       0      0       0       0 0.0000000      0
## 3         0     0       0       0      0       0       0 0.0000000      0
## 4         0     0       0       0      0       0       0 0.0000000      0
## 5         0     0       0       0      0       0       0 0.3333333      0
## 6         0     0       0       0      0       0       0 0.0000000      0
##   parfumee  peau epaisse peau epaisse     sucree  sucree tendre
## 1        0             0   0.00000000 0.00000000       0      0
## 2        0             0   0.00000000 0.00000000       0      0
## 3        0             0   0.00000000 0.02272727       0      0
## 4        0             0   0.00000000 0.02272727       0      0
## 5        0             0   0.02040816 0.00000000       0      0
## 6        0             0   0.00000000 0.02272727       0      0</code></pre>
<pre><code>- sample_mean which gathers for each sample a mean for note and descriptors</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(data_hedonic<span class="op">$</span>data<span class="op">$</span>data_sample_mean)</code></pre>
<pre><code>##         sample germplasm location     note       acide    acidulee
## 1 loc-1:germ-1    germ-1    loc-1 6.125000 0.003586801 0.001742160
## 2 loc-1:germ-2    germ-2    loc-1 6.050000 0.004304161 0.005226481
## 3 loc-1:germ-3    germ-3    loc-1 6.769231 0.002205882 0.001785714
## 4 loc-1:germ-4    germ-4    loc-1 6.871795 0.004411765 0.008928571
## 5 loc-1:germ-5    germ-5    loc-1 5.692308 0.006617647 0.000000000
## 6 loc-1:germ-6    germ-6    loc-1 6.128205 0.003676471 0.007142857
##       charnue       douce       douce  equilibree   farineuse ferme
## 1 0.004065041 0.008130081 0.000000000 0.000000000 0.003048780 0.000
## 2 0.012195122 0.004516712 0.004065041 0.016260163 0.006097561 0.000
## 3 0.004166667 0.001851852 0.008333333 0.008333333 0.000000000 0.010
## 4 0.000000000 0.000000000 0.008333333 0.000000000 0.006250000 0.010
## 5 0.000000000 0.004629630 0.004166667 0.000000000 0.006250000 0.000
## 6 0.004166667 0.005555556 0.000000000 0.000000000 0.003125000 0.005
##   fraiche fruitee      goutue      goutue     juteuse     juteuse
## 1 0.00000 0.00000 0.001742160 0.009756098 0.004065041 0.008130081
## 2 0.00000 0.00000 0.003484321 0.000000000 0.004065041 0.000000000
## 3 0.00625 0.01875 0.003571429 0.005000000 0.005555556 0.000000000
## 4 0.00625 0.00625 0.003571429 0.005000000 0.002777778 0.008333333
## 5 0.00000 0.00000 0.010714286 0.000000000 0.005555556 0.008333333
## 6 0.01250 0.00000 0.001785714 0.005000000 0.002777778 0.000000000
##        neutre    parfumee  peau epaisse peau epaisse      sucree
## 1 0.006968641 0.005420054   0.004065041  0.003982081 0.004434590
## 2 0.005226481 0.002710027   0.004065041  0.003484321 0.004988914
## 3 0.004464286 0.005555556   0.008333333  0.003571429 0.005113636
## 4 0.001785714 0.008333333   0.000000000  0.003571429 0.005113636
## 5 0.002678571 0.000000000   0.008333333  0.005612245 0.001704545
## 6 0.003571429 0.002777778   0.000000000  0.004591837 0.003409091
##        sucree      tendre
## 1 0.004065041 0.000000000
## 2 0.000000000 0.000000000
## 3 0.008333333 0.008333333
## 4 0.004166667 0.000000000
## 5 0.004166667 0.008333333
## 6 0.004166667 0.008333333</code></pre>
<pre><code>- juges which gathers for each juge a mean for note</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(data_hedonic<span class="op">$</span>data<span class="op">$</span>data_juges)</code></pre>
<pre><code>##   juges loc-1:germ-1 loc-1:germ-2 loc-1:germ-3 loc-1:germ-4 loc-1:germ-5
## 1     1            7            5            7            8            6
## 2     2            7            8           NA            6           NA
## 3     4            6            4           NA           NA            3
## 4     5            6           NA            5            7            6
## 5     6            6            5            7            6            3
## 6     7           NA            5            7            6            2
##   loc-1:germ-6  Age Sexe Bio.Non.Bio Circuit Departement
## 1           NA &lt;NA&gt; &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;        &lt;NA&gt;
## 2            7   30    F           1                  11
## 3            7   12    F           1       1        &lt;NA&gt;
## 4            4 &lt;NA&gt;                                 &lt;NA&gt;
## 5            7   49    H           1       1        &lt;NA&gt;
## 6            6   37    F           1       2          11</code></pre>
<ul>
<li><code>var_sup</code> the supplementary variables used in the multivariate analysis</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">data_hedonic<span class="op">$</span>var_sup</code></pre>
<pre><code>## [1] &quot;Age&quot;         &quot;Sexe&quot;        &quot;Bio.Non.Bio&quot; &quot;Circuit&quot;     &quot;Departement&quot;</code></pre>
<ul>
<li><code>descriptors</code> the vector of descriptors cited knowing the threshold applyed when formated the data.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">data_hedonic<span class="op">$</span>descriptors</code></pre>
<pre><code>##  [1] &quot;acide&quot;         &quot;acidulee&quot;      &quot;charnue&quot;       &quot;douce&quot;        
##  [5] &quot; douce&quot;        &quot;equilibree&quot;    &quot;farineuse&quot;     &quot;ferme&quot;        
##  [9] &quot;fraiche&quot;       &quot;fruitee&quot;       &quot;goutue&quot;        &quot; goutue&quot;      
## [13] &quot;juteuse&quot;       &quot; juteuse&quot;      &quot;neutre&quot;        &quot;parfumee&quot;     
## [17] &quot; peau epaisse&quot; &quot;peau epaisse&quot;  &quot;sucree&quot;        &quot; sucree&quot;      
## [21] &quot;tendre&quot;</code></pre>
</div>
<div id="describe-the-data-4" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Describe the data</h3>
<p>First, you can describe the data regarding the note given</p>
<pre class="sourceCode r"><code class="sourceCode r">p_note =<span class="st"> </span><span class="kw">plot</span>(data_hedonic, <span class="dt">plot_type =</span> <span class="st">&quot;boxplot&quot;</span>, <span class="dt">x_axis =</span> <span class="st">&quot;germplasm&quot;</span>,
               <span class="dt">in_col =</span> <span class="st">&quot;location&quot;</span>, <span class="dt">vec_variables =</span> <span class="st">&quot;note&quot;</span>
               )</code></pre>
<pre><code>## Warning in reshape_data_split_x_axis_in_col(d, variable, labels_on,
## x_axis, : 6 rows have been deleted for note because of only NA on the row
## for these variables.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p_note</code></pre>
<pre><code>## $note
## $note$`germplasm-1|location-1`</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-360-1.png" width="672" /></p>
<pre><code>## 
## $note$`germplasm-2|location-1`</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-360-2.png" width="672" /></p>
<p>As well as the descriptors for each germplasm for example:</p>
<pre class="sourceCode r"><code class="sourceCode r">descriptors =<span class="st"> </span>data_hedonic<span class="op">$</span>descriptors

p_des =<span class="st"> </span><span class="kw">plot</span>(data_hedonic, <span class="dt">plot_type =</span> <span class="st">&quot;radar&quot;</span>, <span class="dt">in_col =</span> <span class="st">&quot;germplasm&quot;</span>, 
                         <span class="dt">vec_variables =</span> descriptors
                         )
p_des</code></pre>
<pre><code>## $`all-variables`</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-361-1.png" width="672" /></p>
</div>
<div id="run-the-model-9" class="section level3">
<h3><span class="header-section-number">4.3.5</span> Run the model</h3>
<p>To run the model on the dataset, used the function <code>model_hedonic</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">out_hedonic =<span class="st"> </span><span class="kw">model_hedonic</span>(data_hedonic)</code></pre>
<pre><code>## Warning in PCA(data_juges_hcpc, quanti.sup = id_quanti.sup, quali.sup =
## id_quali.sup, : Missing values are imputed by the mean of the variable: you
## should use the imputePCA function of the missMDA package</code></pre>
<p><code>out_hedonic</code> is a list with three elements:</p>
<ul>
<li><code>model</code> : the result of the anova run on note</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">out_hedonic<span class="op">$</span>model</code></pre>
<pre><code>## 
## Call:
## stats::lm(formula = note ~ juges + germplasm, data = data_sample)
## 
## Coefficients:
##     (Intercept)           juges2           juges4           juges5  
##         6.31772          0.34588         -1.35400         -1.04203  
##          juges6           juges7           juges8           juges9  
##        -0.93390         -1.45714         -2.35549          0.39943  
##         juges10          juges11          juges12          juges13  
##         0.75797          0.56610         -3.26724          0.39943  
##         juges14          juges15          juges16          juges17  
##        -1.19356         -1.35250          1.60000          0.39943  
##         juges19          juges20          juges23          juges24  
##         1.20006         -1.20183         -4.60341          1.14451  
##         juges25          juges26          juges27          juges28  
##         0.90629         -1.35400         -0.42967         -1.70036  
##         juges31          juges32          juges33          juges34  
##        -0.43390         -0.10400          2.27689          1.14451  
##         juges35          juges36          juges37          juges38  
##         0.55797         -1.26724         -0.10057         -0.42057  
##         juges39          juges41          juges42          juges43  
##        -1.60341          0.52540          0.64750          1.46789  
##         juges44          juges45          juges46          juges47  
##        -0.66903         -1.19878         -1.20183         -0.46056  
##         juges49          juges50          juges51          juges52  
##        -0.60057         -0.52690          0.93973         -1.70183  
##         juges53          juges54          juges56          juges57  
##         0.89520         -1.43390          2.11465         -1.58120  
##         juges58          juges59          juges62          juges63  
##        -2.39327         -1.76724         -0.97311          0.56610  
##         juges64          juges65          juges66          juges68  
##         0.14451          1.11465         -1.74361          0.52689  
##         juges69          juges70          juges71          juges72  
##         1.14451         -0.43390         -1.09371          0.65909  
##         juges73          juges74  germplasmgerm-2  germplasmgerm-3  
##         0.56610         -1.13931          0.07555          0.56763  
## germplasmgerm-4  germplasmgerm-5  germplasmgerm-6  
##         0.98436         -0.21612          0.28569</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(out_hedonic<span class="op">$</span>model)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: note
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## juges      61 325.98  5.3439  2.3286 1.071e-05 ***
## germplasm   5  32.83  6.5657  2.8610   0.01657 *  
## Residuals 169 387.84  2.2949                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<ul>
<li><code>CA</code> : the result of the correspondance analysis run on the data set with the supplementary variables with <code>FactoMineR::CA</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">out_hedonic<span class="op">$</span>CA</code></pre>
<pre><code>## **Results of the Correspondence Analysis (CA)**
## The row variable has  6  categories; the column variable has 21 categories
## The chi square of independence between the two variables is equal to 0.3704251 (p-value =  1 ).
## *The results are available in the following objects:
## 
##    name                description                                
## 1  &quot;$eig&quot;              &quot;eigenvalues&quot;                              
## 2  &quot;$col&quot;              &quot;results for the columns&quot;                  
## 3  &quot;$col$coord&quot;        &quot;coord. for the columns&quot;                   
## 4  &quot;$col$cos2&quot;         &quot;cos2 for the columns&quot;                     
## 5  &quot;$col$contrib&quot;      &quot;contributions of the columns&quot;             
## 6  &quot;$row&quot;              &quot;results for the rows&quot;                     
## 7  &quot;$row$coord&quot;        &quot;coord. for the rows&quot;                      
## 8  &quot;$row$cos2&quot;         &quot;cos2 for the rows&quot;                        
## 9  &quot;$row$contrib&quot;      &quot;contributions of the rows&quot;                
## 10 &quot;$quanti.sup$coord&quot; &quot;coord. for supplementary continuous var.&quot; 
## 11 &quot;$quanti.sup$cos2&quot;  &quot;cos2 for supplementary continuous var.&quot;   
## 12 &quot;$quali.sup$coord&quot;  &quot;coord. for supplementary categorical var.&quot;
## 13 &quot;$quali.sup$cos2&quot;   &quot;cos2 for supplementary categorical var.&quot;  
## 14 &quot;$call&quot;             &quot;summary called parameters&quot;                
## 15 &quot;$call$marge.col&quot;   &quot;weights of the columns&quot;                   
## 16 &quot;$call$marge.row&quot;   &quot;weights of the rows&quot;</code></pre>
<ul>
<li><code>HCPC</code> : the result of the correspondane analysis run on the data set with the supplementary variables with <code>FactoMineR::PCA</code> follow by <code>FactoMineR::HCPC</code>.
It is a list of three elements:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">out_hedonic<span class="op">$</span>HCPC<span class="op">$</span>res.pca</code></pre>
<pre><code>## **Results for the Principal Component Analysis (PCA)**
## The analysis was performed on 63 individuals, described by 11 variables
## *The results are available in the following objects:
## 
##    name               
## 1  &quot;$eig&quot;             
## 2  &quot;$var&quot;             
## 3  &quot;$var$coord&quot;       
## 4  &quot;$var$cor&quot;         
## 5  &quot;$var$cos2&quot;        
## 6  &quot;$var$contrib&quot;     
## 7  &quot;$ind&quot;             
## 8  &quot;$ind$coord&quot;       
## 9  &quot;$ind$cos2&quot;        
## 10 &quot;$ind$contrib&quot;     
## 11 &quot;$quali.sup&quot;       
## 12 &quot;$quali.sup$coord&quot; 
## 13 &quot;$quali.sup$v.test&quot;
## 14 &quot;$call&quot;            
## 15 &quot;$call$centre&quot;     
## 16 &quot;$call$ecart.type&quot; 
## 17 &quot;$call$row.w&quot;      
## 18 &quot;$call$col.w&quot;      
##    description                                          
## 1  &quot;eigenvalues&quot;                                        
## 2  &quot;results for the variables&quot;                          
## 3  &quot;coord. for the variables&quot;                           
## 4  &quot;correlations variables - dimensions&quot;                
## 5  &quot;cos2 for the variables&quot;                             
## 6  &quot;contributions of the variables&quot;                     
## 7  &quot;results for the individuals&quot;                        
## 8  &quot;coord. for the individuals&quot;                         
## 9  &quot;cos2 for the individuals&quot;                           
## 10 &quot;contributions of the individuals&quot;                   
## 11 &quot;results for the supplementary categorical variables&quot;
## 12 &quot;coord. for the supplementary categories&quot;            
## 13 &quot;v-test of the supplementary categories&quot;             
## 14 &quot;summary statistics&quot;                                 
## 15 &quot;mean of the variables&quot;                              
## 16 &quot;standard error of the variables&quot;                    
## 17 &quot;weights for the individuals&quot;                        
## 18 &quot;weights for the variables&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">out_hedonic<span class="op">$</span>HCPC<span class="op">$</span>res.hcpc</code></pre>
<pre><code>## **Results for the Hierarchical Clustering on Principal Components**
##    name                   
## 1  &quot;$data.clust&quot;          
## 2  &quot;$desc.var&quot;            
## 3  &quot;$desc.var$quanti.var&quot; 
## 4  &quot;$desc.var$quanti&quot;     
## 5  &quot;$desc.var$test.chi2&quot;  
## 6  &quot;$desc.axes$category&quot;  
## 7  &quot;$desc.axes&quot;           
## 8  &quot;$desc.axes$quanti.var&quot;
## 9  &quot;$desc.axes$quanti&quot;    
## 10 &quot;$desc.ind&quot;            
## 11 &quot;$desc.ind$para&quot;       
## 12 &quot;$desc.ind$dist&quot;       
## 13 &quot;$call&quot;                
## 14 &quot;$call$t&quot;              
##    description                                              
## 1  &quot;dataset with the cluster of the individuals&quot;            
## 2  &quot;description of the clusters by the variables&quot;           
## 3  &quot;description of the cluster var. by the continuous var.&quot; 
## 4  &quot;description of the clusters by the continuous var.&quot;     
## 5  &quot;description of the cluster var. by the categorical var.&quot;
## 6  &quot;description of the clusters by the categories.&quot;         
## 7  &quot;description of the clusters by the dimensions&quot;          
## 8  &quot;description of the cluster var. by the axes&quot;            
## 9  &quot;description of the clusters by the axes&quot;                
## 10 &quot;description of the clusters by the individuals&quot;         
## 11 &quot;parangons of each clusters&quot;                             
## 12 &quot;specific individuals&quot;                                   
## 13 &quot;summary statistics&quot;                                     
## 14 &quot;description of the tree&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(out_hedonic<span class="op">$</span>HCPC<span class="op">$</span>clust)</code></pre>
<pre><code>##   loc-1:germ-1 loc-1:germ-2 loc-1:germ-3 loc-1:germ-4 loc-1:germ-5
## 1        7.000         5.00     7.000000     8.000000     6.000000
## 2        7.000         8.00     6.769231     6.000000     5.692308
## 4        6.000         4.00     6.769231     6.871795     3.000000
## 5        6.000         6.05     5.000000     7.000000     6.000000
## 6        6.000         5.00     7.000000     6.000000     3.000000
## 7        6.125         5.00     7.000000     6.000000     2.000000
##   loc-1:germ-6  Age Sexe Bio.Non.Bio Circuit Departement     clust
## 1     6.128205 &lt;NA&gt; &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;        &lt;NA&gt; cluster 6
## 2     7.000000   30    F           1                  11 cluster 5
## 4     7.000000   12    F           1       1        &lt;NA&gt; cluster 4
## 5     4.000000 &lt;NA&gt;                                 &lt;NA&gt; cluster 3
## 6     7.000000   49    H           1       1        &lt;NA&gt; cluster 4
## 7     6.000000   37    F           1       2          11 cluster 4</code></pre>
</div>
<div id="check-and-visualize-model-outputs-9" class="section level3">
<h3><span class="header-section-number">4.3.6</span> Check and visualize model outputs</h3>
<p>The tests to check the model are explained in section <a href="intro-agro.html#check-model-freq">3.1.2.1.2</a>.</p>
<div id="check-the-model-9" class="section level4">
<h4><span class="header-section-number">4.3.6.1</span> Check the model</h4>
<pre class="sourceCode r"><code class="sourceCode r">out_check_hedonic =<span class="st"> </span><span class="kw">check_model</span>(out_hedonic)</code></pre>
<p><code>out_check_hedonic</code> is list with two elements:</p>
<ul>
<li><code>hedonic</code> which it the same objet as <code>out_hedonic</code></li>
<li><code>data_ggplot</code> a list containing information for ggplot:
<ul>
<li><code>data_ggplot_residuals</code> a list containing :
<ul>
<li><code>data_ggplot_normality</code></li>
<li><code>data_ggplot_skewness_test</code></li>
<li><code>data_ggplot_kurtosis_test</code></li>
<li><code>data_ggplot_shapiro_test</code></li>
<li><code>data_ggplot_qqplot</code></li>
</ul></li>
<li><code>data_ggplot_variability_repartition_pie</code></li>
<li><code>data_ggplot_var_intra</code></li>
</ul></li>
</ul>
</div>
<div id="visualize-outputs-10" class="section level4">
<h4><span class="header-section-number">4.3.6.2</span> Visualize outputs</h4>
<p>Once the computation is done, you can visualize the results with <code>plot()</code></p>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_hedonic =<span class="st"> </span><span class="kw">plot</span>(out_check_hedonic)</code></pre>
<p><code>p_out_check_hedonic</code> is a list with:</p>
<ul>
<li><code>residuals</code> of the ANOVA model
<ul>
<li><code>histogram</code> : histogram with the distribution of the residuals</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_hedonic<span class="op">$</span>residuals<span class="op">$</span>histogram</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<img src="PPBstats_book_files/figure-html/unnamed-chunk-370-1.png" width="672" />
<ul>
<li><code>qqplot</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_hedonic<span class="op">$</span>residuals<span class="op">$</span>qqplot</code></pre>
<img src="PPBstats_book_files/figure-html/unnamed-chunk-371-1.png" width="672" />
<ul>
<li><code>points</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_hedonic<span class="op">$</span>residuals<span class="op">$</span>points</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-372-1.png" width="672" /></p></li>
<li><p><code>variability_repartition</code> : pie with repartition of SumSq for each factor of the ANOVA model</p></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_hedonic<span class="op">$</span>variability_repartition</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-373-1.png" width="672" /></p>
<ul>
<li><code>variance_intra_germplasm</code> : repartition of the residuals for each germplasm which represent the person assessor variation plus the intra-germplasm variance of the ANOVA model.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_hedonic<span class="op">$</span>variance_intra_germplasm</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-374-1.png" width="672" /></p>
<ul>
<li><code>CA_composante_variance</code> : variance caught by each dimension of the CA</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_hedonic<span class="op">$</span>CA_composante_variance</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-375-1.png" width="672" /></p>
<ul>
<li><code>HCPC_composante_variance</code> : variance caught by each dimension of the PCA previous to the HCPC</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_check_hedonic<span class="op">$</span>PCA_composante_variance</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-376-1.png" width="672" /></p>
</div>
</div>
<div id="get-and-visualize-mean-comparisons-on-note" class="section level3">
<h3><span class="header-section-number">4.3.7</span> Get and visualize mean comparisons on note</h3>
<p>The method to compute mean comparison are explained in section <a href="intro-agro.html#mean-comp-check-freq">3.1.2.1.3</a>.</p>
<div id="get-mean-comparisons-on-note" class="section level4">
<h4><span class="header-section-number">4.3.7.1</span> Get mean comparisons on note</h4>
<p>Get mean comparisons with <code>mean_comparisons()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">out_mean_comparisons_hedonic =<span class="st"> </span><span class="kw">mean_comparisons</span>(out_check_hedonic)</code></pre>
<p><code>out_mean_comparisons_hedonic</code> is a list of one element for futher ggplot : <code>data_ggplot_LSDbarplot_germplasm</code></p>
</div>
<div id="visualize-mean-comparisons-on-note" class="section level4">
<h4><span class="header-section-number">4.3.7.2</span> Visualize mean comparisons on note</h4>
<pre class="sourceCode r"><code class="sourceCode r">p_out_mean_comparisons_hedonic =<span class="st"> </span><span class="kw">plot</span>(out_mean_comparisons_hedonic)</code></pre>
<p><code>p_out_mean_comparisons_hedonic</code> is a list of on elements with barplots :</p>
<p>For each element of the list, there are as many graph as needed with <code>nb_parameters_per_plot</code> parameters per graph.
Letters are displayed on each bar.
Parameters that do not share the same letters are different regarding type I error (alpha) and alpha correction.
The error I (alpha) and the alpha correction are displayed in the title.</p>
<ul>
<li><code>germplasm</code> : mean comparison for germplasm</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">pg =<span class="st"> </span>p_out_mean_comparisons_hedonic<span class="op">$</span>germplasm
<span class="kw">names</span>(pg)</code></pre>
<pre><code>## [1] &quot;1&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">pg<span class="op">$</span><span class="st">`</span><span class="dt">1</span><span class="st">`</span></code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-379-1.png" width="672" /></p>
</div>
</div>
<div id="get-and-visualize-biplot-regarding-samples-ca-and-juges-hcpc" class="section level3">
<h3><span class="header-section-number">4.3.8</span> Get and visualize biplot regarding samples (CA) and juges (HCPC)</h3>
<p>The biplot represents information about the percentages of total variation explained by the two axes.
It has to be linked to the total variation caught by the interaction.
If the total variation is small, then the biplot is useless.
If the total variation is high enought, then the biplot is useful if the two first dimension represented catch enought variation (the more the better).</p>
<div id="get-biplot-2" class="section level4">
<h4><span class="header-section-number">4.3.8.1</span> Get biplot</h4>
<p>Get biplot regading samples (CA) and juges (HCPC)</p>
<pre class="sourceCode r"><code class="sourceCode r">out_biplot_hedonic =<span class="st"> </span><span class="kw">biplot_data</span>(out_check_hedonic)</code></pre>
</div>
<div id="visualize-biplot-2" class="section level4">
<h4><span class="header-section-number">4.3.8.2</span> Visualize biplot</h4>
<pre class="sourceCode r"><code class="sourceCode r">p_out_biplot_hedonic =<span class="st"> </span><span class="kw">plot</span>(out_biplot_hedonic)</code></pre>
<p><code>p_out_biplot_hedonic</code> is a list of two elements with</p>
<ul>
<li>the <code>CA</code> biplot where descriptors are represented by a triangle in red and samples are represented by text in blue and point in color refering to the sample.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_biplot_hedonic<span class="op">$</span>ca_biplot</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-382-1.png" width="672" /></p>
<ul>
<li>the <code>HCPC</code> biplot is a list of two elements : one with the variable ans the additionnal variables and the other with the groups of juges detected by the <code>HCPC</code>.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">p_out_biplot_hedonic<span class="op">$</span>hcpc_biplot</code></pre>
<pre><code>## $var</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-383-1.png" width="672" /></p>
<pre><code>## 
## $cluster</code></pre>
<p><img src="PPBstats_book_files/figure-html/unnamed-chunk-383-2.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="taste.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="napping.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/priviere/PPBstats/edit/master/403-organo_hedonic.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["PPBstats_book.pdf", "PPBstats_book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
